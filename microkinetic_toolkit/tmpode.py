import numpy as np

def func(t, c, kfor, Kc, T, sden, area, Vr, ngas, ncomp):

	krev = kfor / Kc
	theta = c[0:ncomp]
	theta = theta * sden
	rate = np.zeros(28)

	rate[0] = + 1.0*kfor[33]*theta[9]*(area/Vr) - 1.0*krev[33]*c[0]*theta[27]*(area/Vr)  # CH3OH
	rate[1] = + 1.0*kfor[32]*theta[12]*(area/Vr) - 1.0*krev[32]*c[1]*theta[27]*(area/Vr)  # CH4
	rate[2] = + 1.0*kfor[30]*theta[18]*(area/Vr) - 1.0*krev[30]*c[2]*theta[27]*(area/Vr)  # CO
	rate[3] = - 1.0*kfor[29]*c[3]*theta[27]*(area/Vr) + 1.0*krev[29]*theta[16]*(area/Vr)  # CO2
	rate[4] = - 1.0*kfor[24]*c[4]*theta[27]**2*(area/Vr) + 1.0*krev[24]*theta[24]**2*(area/Vr)  # H2
	rate[5] = + 1.0*kfor[31]*theta[22]*(area/Vr) - 1.0*krev[31]*c[5]*theta[27]*(area/Vr)  # H2O
	rate[6] = - 1.0*kfor[6]*theta[6]*theta[24]*(area/Vr) + 1.0*krev[6]*theta[9]*theta[27]*(area/Vr) + 1.0*kfor[7]*theta[13]*theta[24]*(area/Vr) - 1.0*krev[7]*theta[6]*theta[27]*(area/Vr) - 1.0*kfor[11]*theta[6]*theta[27]*(area/Vr) + 1.0*krev[11]*theta[8]*theta[25]*(area/Vr) - 1.0*kfor[21]*theta[6]*theta[27]*(area/Vr) + 1.0*krev[21]*theta[7]*theta[24]*(area/Vr)  # CH2OH_surf
	rate[7] = - 1.0*kfor[14]*theta[7]*theta[24]*(area/Vr) + 1.0*krev[14]*theta[10]*theta[27]*(area/Vr) + 1.0*kfor[15]*theta[14]*theta[24]*(area/Vr) - 1.0*krev[15]*theta[7]*theta[27]*(area/Vr) + 1.0*kfor[17]*theta[8]*theta[26]*(area/Vr) - 1.0*krev[17]*theta[7]*theta[27]*(area/Vr) + 1.0*kfor[21]*theta[6]*theta[27]*(area/Vr) - 1.0*krev[21]*theta[7]*theta[24]*(area/Vr)  # CH2O_surf
	rate[8] = - 1.0*kfor[1]*theta[8]*theta[24]*(area/Vr) + 1.0*krev[1]*theta[11]*theta[27]*(area/Vr) + 1.0*kfor[2]*theta[15]*theta[24]*(area/Vr) - 1.0*krev[2]*theta[8]*theta[27]*(area/Vr) + 1.0*kfor[11]*theta[6]*theta[27]*(area/Vr) - 1.0*krev[11]*theta[8]*theta[25]*(area/Vr) - 1.0*kfor[17]*theta[8]*theta[26]*(area/Vr) + 1.0*krev[17]*theta[7]*theta[27]*(area/Vr)  # CH2_surf
	rate[9] = + 1.0*kfor[6]*theta[6]*theta[24]*(area/Vr) - 1.0*krev[6]*theta[9]*theta[27]*(area/Vr) - 1.0*kfor[10]*theta[9]*theta[27]*(area/Vr) + 1.0*krev[10]*theta[11]*theta[25]*(area/Vr) - 1.0*kfor[20]*theta[9]*theta[27]*(area/Vr) + 1.0*krev[20]*theta[10]*theta[24]*(area/Vr) - 1.0*kfor[33]*theta[9]*(area/Vr) + 1.0*krev[33]*c[0]*theta[27]*(area/Vr)  # CH3OH_surf
	rate[10] = + 1.0*kfor[14]*theta[7]*theta[24]*(area/Vr) - 1.0*krev[14]*theta[10]*theta[27]*(area/Vr) - 1.0*kfor[16]*theta[10]*theta[27]*(area/Vr) + 1.0*krev[16]*theta[11]*theta[26]*(area/Vr) + 1.0*kfor[20]*theta[9]*theta[27]*(area/Vr) - 1.0*krev[20]*theta[10]*theta[24]*(area/Vr)  # CH3O_surf
	rate[11] = - 1.0*kfor[0]*theta[11]*theta[24]*(area/Vr) + 1.0*krev[0]*theta[12]*theta[27]*(area/Vr) + 1.0*kfor[1]*theta[8]*theta[24]*(area/Vr) - 1.0*krev[1]*theta[11]*theta[27]*(area/Vr) + 1.0*kfor[10]*theta[9]*theta[27]*(area/Vr) - 1.0*krev[10]*theta[11]*theta[25]*(area/Vr) + 1.0*kfor[16]*theta[10]*theta[27]*(area/Vr) - 1.0*krev[16]*theta[11]*theta[26]*(area/Vr)  # CH3_surf
	rate[12] = + 1.0*kfor[0]*theta[11]*theta[24]*(area/Vr) - 1.0*krev[0]*theta[12]*theta[27]*(area/Vr) - 1.0*kfor[32]*theta[12]*(area/Vr) + 1.0*krev[32]*c[1]*theta[27]*(area/Vr)  # CH4_surf
	rate[13] = - 1.0*kfor[7]*theta[13]*theta[24]*(area/Vr) + 1.0*krev[7]*theta[6]*theta[27]*(area/Vr) + 1.0*kfor[8]*theta[17]*theta[24]*(area/Vr) - 1.0*krev[8]*theta[13]*theta[27]*(area/Vr) - 1.0*kfor[12]*theta[13]*theta[27]*(area/Vr) + 1.0*krev[12]*theta[15]*theta[25]*(area/Vr)  # CHOH_surf
	rate[14] = - 1.0*kfor[15]*theta[14]*theta[24]*(area/Vr) + 1.0*krev[15]*theta[7]*theta[27]*(area/Vr) - 1.0*kfor[18]*theta[14]*theta[27]*(area/Vr) + 1.0*krev[18]*theta[15]*theta[26]*(area/Vr)  # CHO_surf
	rate[15] = - 1.0*kfor[2]*theta[15]*theta[24]*(area/Vr) + 1.0*krev[2]*theta[8]*theta[27]*(area/Vr) + 1.0*kfor[3]*theta[19]*theta[24]*(area/Vr) - 1.0*krev[3]*theta[15]*theta[27]*(area/Vr) + 1.0*kfor[12]*theta[13]*theta[27]*(area/Vr) - 1.0*krev[12]*theta[15]*theta[25]*(area/Vr) + 1.0*kfor[18]*theta[14]*theta[27]*(area/Vr) - 1.0*krev[18]*theta[15]*theta[26]*(area/Vr)  # CH_surf
	rate[16] = - 1.0*kfor[4]*theta[16]*theta[27]*(area/Vr) + 1.0*krev[4]*theta[18]*theta[26]*(area/Vr) - 1.0*kfor[5]*theta[16]*theta[24]*(area/Vr) + 1.0*krev[5]*theta[23]*theta[27]*(area/Vr) - 1.0*kfor[26]*theta[16]*theta[19]*(area/Vr) + 1.0*krev[26]*theta[18]**2*(area/Vr) + 1.0*kfor[29]*c[3]*theta[27]*(area/Vr) - 1.0*krev[29]*theta[16]*(area/Vr)  # CO2_surf
	rate[17] = - 1.0*kfor[8]*theta[17]*theta[24]*(area/Vr) + 1.0*krev[8]*theta[13]*theta[27]*(area/Vr) + 1.0*kfor[9]*theta[18]*theta[24]*(area/Vr) - 1.0*krev[9]*theta[17]*theta[27]*(area/Vr) - 1.0*kfor[13]*theta[17]*theta[27]*(area/Vr) + 1.0*krev[13]*theta[19]*theta[25]*(area/Vr)  # COH_surf
	rate[18] = + 1.0*kfor[4]*theta[16]*theta[27]*(area/Vr) - 1.0*krev[4]*theta[18]*theta[26]*(area/Vr) - 1.0*kfor[9]*theta[18]*theta[24]*(area/Vr) + 1.0*krev[9]*theta[17]*theta[27]*(area/Vr) - 1.0*kfor[19]*theta[18]*theta[27]*(area/Vr) + 1.0*krev[19]*theta[19]*theta[26]*(area/Vr) + 2.0*kfor[26]*theta[16]*theta[19]*(area/Vr) - 2.0*krev[26]*theta[18]**2*(area/Vr) - 1.0*kfor[30]*theta[18]*(area/Vr) + 1.0*krev[30]*c[2]*theta[27]*(area/Vr)  # CO_surf
	rate[19] = - 1.0*kfor[3]*theta[19]*theta[24]*(area/Vr) + 1.0*krev[3]*theta[15]*theta[27]*(area/Vr) + 1.0*kfor[13]*theta[17]*theta[27]*(area/Vr) - 1.0*krev[13]*theta[19]*theta[25]*(area/Vr) + 1.0*kfor[19]*theta[18]*theta[27]*(area/Vr) - 1.0*krev[19]*theta[19]*theta[26]*(area/Vr) - 1.0*kfor[26]*theta[16]*theta[19]*(area/Vr) + 1.0*krev[26]*theta[18]**2*(area/Vr)  # C_surf
	rate[20] = + 1.0*kfor[28]*theta[21]*theta[24]*(area/Vr) - 1.0*krev[28]*theta[20]*theta[27]*(area/Vr)  # H2COOH_surf
	rate[21] = + 1.0*kfor[27]*theta[23]*theta[24]*(area/Vr) - 1.0*krev[27]*theta[21]*theta[27]*(area/Vr) - 1.0*kfor[28]*theta[21]*theta[24]*(area/Vr) + 1.0*krev[28]*theta[20]*theta[27]*(area/Vr)  # H2COO_surf
	rate[22] = + 1.0*kfor[23]*theta[25]*theta[24]*(area/Vr) - 1.0*krev[23]*theta[22]*theta[27]*(area/Vr) + 1.0*kfor[25]*theta[25]*theta[25]*(area/Vr) - 1.0*krev[25]*theta[22]*theta[26]*(area/Vr) - 1.0*kfor[31]*theta[22]*(area/Vr) + 1.0*krev[31]*c[5]*theta[27]*(area/Vr)  # H2O_surf
	rate[23] = + 1.0*kfor[5]*theta[16]*theta[24]*(area/Vr) - 1.0*krev[5]*theta[23]*theta[27]*(area/Vr) - 1.0*kfor[27]*theta[23]*theta[24]*(area/Vr) + 1.0*krev[27]*theta[21]*theta[27]*(area/Vr)  # HCOO_surf
	rate[24] = - 1.0*kfor[0]*theta[11]*theta[24]*(area/Vr) + 1.0*krev[0]*theta[12]*theta[27]*(area/Vr) - 1.0*kfor[1]*theta[8]*theta[24]*(area/Vr) + 1.0*krev[1]*theta[11]*theta[27]*(area/Vr) - 1.0*kfor[2]*theta[15]*theta[24]*(area/Vr) + 1.0*krev[2]*theta[8]*theta[27]*(area/Vr) - 1.0*kfor[3]*theta[19]*theta[24]*(area/Vr) + 1.0*krev[3]*theta[15]*theta[27]*(area/Vr) - 1.0*kfor[5]*theta[16]*theta[24]*(area/Vr) + 1.0*krev[5]*theta[23]*theta[27]*(area/Vr) - 1.0*kfor[6]*theta[6]*theta[24]*(area/Vr) + 1.0*krev[6]*theta[9]*theta[27]*(area/Vr) - 1.0*kfor[7]*theta[13]*theta[24]*(area/Vr) + 1.0*krev[7]*theta[6]*theta[27]*(area/Vr) - 1.0*kfor[8]*theta[17]*theta[24]*(area/Vr) + 1.0*krev[8]*theta[13]*theta[27]*(area/Vr) - 1.0*kfor[9]*theta[18]*theta[24]*(area/Vr) + 1.0*krev[9]*theta[17]*theta[27]*(area/Vr) - 1.0*kfor[14]*theta[7]*theta[24]*(area/Vr) + 1.0*krev[14]*theta[10]*theta[27]*(area/Vr) - 1.0*kfor[15]*theta[14]*theta[24]*(area/Vr) + 1.0*krev[15]*theta[7]*theta[27]*(area/Vr) + 1.0*kfor[20]*theta[9]*theta[27]*(area/Vr) - 1.0*krev[20]*theta[10]*theta[24]*(area/Vr) + 1.0*kfor[21]*theta[6]*theta[27]*(area/Vr) - 1.0*krev[21]*theta[7]*theta[24]*(area/Vr) - 1.0*kfor[22]*theta[26]*theta[24]*(area/Vr) + 1.0*krev[22]*theta[25]*theta[27]*(area/Vr) - 1.0*kfor[23]*theta[25]*theta[24]*(area/Vr) + 1.0*krev[23]*theta[22]*theta[27]*(area/Vr) + 2.0*kfor[24]*c[4]*theta[27]**2*(area/Vr) - 2.0*krev[24]*theta[24]**2*(area/Vr) - 1.0*kfor[27]*theta[23]*theta[24]*(area/Vr) + 1.0*krev[27]*theta[21]*theta[27]*(area/Vr) - 1.0*kfor[28]*theta[21]*theta[24]*(area/Vr) + 1.0*krev[28]*theta[20]*theta[27]*(area/Vr)  # H_surf
	rate[25] = + 1.0*kfor[10]*theta[9]*theta[27]*(area/Vr) - 1.0*krev[10]*theta[11]*theta[25]*(area/Vr) + 1.0*kfor[11]*theta[6]*theta[27]*(area/Vr) - 1.0*krev[11]*theta[8]*theta[25]*(area/Vr) + 1.0*kfor[12]*theta[13]*theta[27]*(area/Vr) - 1.0*krev[12]*theta[15]*theta[25]*(area/Vr) + 1.0*kfor[13]*theta[17]*theta[27]*(area/Vr) - 1.0*krev[13]*theta[19]*theta[25]*(area/Vr) + 1.0*kfor[22]*theta[26]*theta[24]*(area/Vr) - 1.0*krev[22]*theta[25]*theta[27]*(area/Vr) - 1.0*kfor[23]*theta[25]*theta[24]*(area/Vr) + 1.0*krev[23]*theta[22]*theta[27]*(area/Vr) - 1.0*kfor[25]*theta[25]*theta[25]*(area/Vr) - 1.0*kfor[25]*theta[25]*theta[25]*(area/Vr) + 1.0*krev[25]*theta[22]*theta[26]*(area/Vr) + 1.0*krev[25]*theta[22]*theta[26]*(area/Vr)  # OH_surf
	rate[26] = + 1.0*kfor[4]*theta[16]*theta[27]*(area/Vr) - 1.0*krev[4]*theta[18]*theta[26]*(area/Vr) + 1.0*kfor[16]*theta[10]*theta[27]*(area/Vr) - 1.0*krev[16]*theta[11]*theta[26]*(area/Vr) - 1.0*kfor[17]*theta[8]*theta[26]*(area/Vr) + 1.0*krev[17]*theta[7]*theta[27]*(area/Vr) + 1.0*kfor[18]*theta[14]*theta[27]*(area/Vr) - 1.0*krev[18]*theta[15]*theta[26]*(area/Vr) + 1.0*kfor[19]*theta[18]*theta[27]*(area/Vr) - 1.0*krev[19]*theta[19]*theta[26]*(area/Vr) - 1.0*kfor[22]*theta[26]*theta[24]*(area/Vr) + 1.0*krev[22]*theta[25]*theta[27]*(area/Vr) + 1.0*kfor[25]*theta[25]*theta[25]*(area/Vr) - 1.0*krev[25]*theta[22]*theta[26]*(area/Vr)  # O_surf
	rate[27] = -rate[6] -rate[7] -rate[8] -rate[9] -rate[10] -rate[11] -rate[12] -rate[13] -rate[14] -rate[15] -rate[16] -rate[17] -rate[18] -rate[19] -rate[20] -rate[21] -rate[22] -rate[23] -rate[24] -rate[25] -rate[26]  # surf

	# species --- 0 = CH3OH 1 = CH4 2 = CO 3 = CO2 4 = H2 5 = H2O 6 = CH2OH_surf 7 = CH2O_surf 8 = CH2_surf 9 = CH3OH_surf 10 = CH3O_surf 11 = CH3_surf 12 = CH4_surf 13 = CHOH_surf 14 = CHO_surf 15 = CH_surf 16 = CO2_surf 17 = COH_surf 18 = CO_surf 19 = C_surf 20 = H2COOH_surf 21 = H2COO_surf 22 = H2O_surf 23 = HCOO_surf 24 = H_surf 25 = OH_surf 26 = O_surf 27 = surf 
	if ncomp > ngas:
		rate[ngas:ncomp] = rate[ngas:ncomp]*(1/sden)  # surface
	return rate

