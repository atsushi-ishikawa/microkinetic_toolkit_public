<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>microkinetic_toolkit.create_input &mdash; microkinetic_toolkit  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> microkinetic_toolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../example.html">example module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../microkinetic_toolkit.html">microkinetic_toolkit package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">setup module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">microkinetic_toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>microkinetic_toolkit.create_input</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for microkinetic_toolkit.create_input</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="c1"># Copyright (C) 2008 CSC - Scientific Computing Ltd.</span>
<span class="sd">&quot;&quot;&quot;This module defines an ASE interface to VASP.</span>

<span class="sd">Developed on the basis of modules by Jussi Enkovaara and John</span>
<span class="sd">Kitchin.  The path of the directory containing the pseudopotential</span>
<span class="sd">directories (potpaw,potpaw_GGA, potpaw_PBE, ...) should be set</span>
<span class="sd">by the environmental flag $VASP_PP_PATH.</span>

<span class="sd">The user should also set the environmental flag $VASP_SCRIPT pointing</span>
<span class="sd">to a python script looking something like::</span>

<span class="sd">   import os</span>
<span class="sd">   exitcode = os.system(&#39;vasp&#39;)</span>

<span class="sd">Alternatively, user can set the environmental flag $VASP_COMMAND pointing</span>
<span class="sd">to the command use the launch vasp e.g. &#39;vasp&#39; or &#39;mpirun -n 16 vasp&#39;</span>

<span class="sd">http://cms.mpi.univie.ac.at/vasp/</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">islink</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">ase.calculators.calculator</span> <span class="kn">import</span> <span class="n">kpts2ndarray</span>
<span class="kn">from</span> <span class="nn">ase.utils</span> <span class="kn">import</span> <span class="n">basestring</span>

<span class="c1"># Parameters that can be set in INCAR. The values which are None</span>
<span class="c1"># are not written and default parameters of VASP are used for them.</span>

<span class="n">float_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;aexx&#39;</span><span class="p">,</span>       <span class="c1"># Fraction of exact/DFT exchange</span>
    <span class="s1">&#39;aggac&#39;</span><span class="p">,</span>      <span class="c1"># Fraction of gradient correction to correlation</span>
    <span class="s1">&#39;aggax&#39;</span><span class="p">,</span>      <span class="c1"># Fraction of gradient correction to exchange</span>
    <span class="s1">&#39;aldac&#39;</span><span class="p">,</span>      <span class="c1"># Fraction of LDA correlation energy</span>
    <span class="s1">&#39;amin&#39;</span><span class="p">,</span>       <span class="c1">#</span>
    <span class="s1">&#39;amix&#39;</span><span class="p">,</span>       <span class="c1">#</span>
    <span class="s1">&#39;amix_mag&#39;</span><span class="p">,</span>   <span class="c1">#</span>
    <span class="s1">&#39;bmix&#39;</span><span class="p">,</span>       <span class="c1"># tags for mixing</span>
    <span class="s1">&#39;bmix_mag&#39;</span><span class="p">,</span>   <span class="c1">#</span>
    <span class="s1">&#39;cshift&#39;</span><span class="p">,</span>     <span class="c1"># Complex shift for dielectric tensor calculation (LOPTICS)</span>
    <span class="s1">&#39;deper&#39;</span><span class="p">,</span>      <span class="c1"># relative stopping criterion for optimization of eigenvalue</span>
    <span class="s1">&#39;ebreak&#39;</span><span class="p">,</span>     <span class="c1"># absolute stopping criterion for optimization of eigenvalues</span>
                  <span class="c1"># (EDIFF/N-BANDS/4)</span>
    <span class="s1">&#39;efield&#39;</span><span class="p">,</span>     <span class="c1"># applied electrostatic field</span>
    <span class="s1">&#39;emax&#39;</span><span class="p">,</span>       <span class="c1"># energy-range for DOSCAR file</span>
    <span class="s1">&#39;emin&#39;</span><span class="p">,</span>       <span class="c1">#</span>
    <span class="s1">&#39;enaug&#39;</span><span class="p">,</span>      <span class="c1"># Density cutoff</span>
    <span class="s1">&#39;encut&#39;</span><span class="p">,</span>      <span class="c1"># Planewave cutoff</span>
    <span class="s1">&#39;encutgw&#39;</span><span class="p">,</span>    <span class="c1"># energy cutoff for response function</span>
    <span class="s1">&#39;encutfock&#39;</span><span class="p">,</span>  <span class="c1"># FFT grid in the HF related routines</span>
    <span class="s1">&#39;hfscreen&#39;</span><span class="p">,</span>   <span class="c1"># attribute to change from PBE0 to HSE</span>
    <span class="s1">&#39;kspacing&#39;</span><span class="p">,</span>   <span class="c1"># determines the number of k-points if the KPOINTS</span>
                  <span class="c1"># file is not present. KSPACING is the smallest</span>
                  <span class="c1"># allowed spacing between k-points in units of</span>
                  <span class="c1"># $\AA$^{-1}$.</span>
    <span class="s1">&#39;potim&#39;</span><span class="p">,</span>      <span class="c1"># time-step for ion-motion (fs)</span>
    <span class="s1">&#39;nelect&#39;</span><span class="p">,</span>     <span class="c1"># total number of electrons</span>
    <span class="s1">&#39;param1&#39;</span><span class="p">,</span>     <span class="c1"># Exchange parameter</span>
    <span class="s1">&#39;param2&#39;</span><span class="p">,</span>     <span class="c1"># Exchange parameter</span>
    <span class="s1">&#39;pomass&#39;</span><span class="p">,</span>     <span class="c1"># mass of ions in am</span>
    <span class="s1">&#39;pstress&#39;</span><span class="p">,</span>    <span class="c1"># add this stress to the stress tensor, and energy E = V *</span>
                  <span class="c1"># pstress</span>
    <span class="s1">&#39;sigma&#39;</span><span class="p">,</span>      <span class="c1"># broadening in eV</span>
    <span class="s1">&#39;smass&#39;</span><span class="p">,</span>      <span class="c1"># Nose mass-parameter (am)</span>
    <span class="s1">&#39;spring&#39;</span><span class="p">,</span>     <span class="c1"># spring constant for NEB</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>       <span class="c1"># special control tag</span>
    <span class="s1">&#39;weimin&#39;</span><span class="p">,</span>     <span class="c1"># maximum weight for a band to be considered empty</span>
    <span class="s1">&#39;zab_vdw&#39;</span><span class="p">,</span>    <span class="c1"># vdW-DF parameter</span>
    <span class="s1">&#39;zval&#39;</span><span class="p">,</span>       <span class="c1"># ionic valence</span>
    <span class="c1"># The next keywords pertain to the VTST add-ons from Graeme Henkelman&#39;s</span>
    <span class="c1"># group at UT Austin</span>
    <span class="s1">&#39;jacobian&#39;</span><span class="p">,</span>   <span class="c1"># Weight of lattice to atomic motion</span>
    <span class="s1">&#39;ddr&#39;</span><span class="p">,</span>        <span class="c1"># (DdR) dimer separation</span>
    <span class="s1">&#39;drotmax&#39;</span><span class="p">,</span>    <span class="c1"># (DRotMax) number of rotation steps per translation step</span>
    <span class="s1">&#39;dfnmin&#39;</span><span class="p">,</span>     <span class="c1"># (DFNMin) rotational force below which dimer is not rotated</span>
    <span class="s1">&#39;dfnmax&#39;</span><span class="p">,</span>     <span class="c1"># (DFNMax) rotational force below which dimer rotation stops</span>
    <span class="s1">&#39;sltol&#39;</span><span class="p">,</span>      <span class="c1"># convergence ratio for minimum eigenvalue</span>
    <span class="s1">&#39;sdr&#39;</span><span class="p">,</span>        <span class="c1"># finite difference for setting up Lanczos matrix and step</span>
                  <span class="c1"># size when translating</span>
    <span class="s1">&#39;maxmove&#39;</span><span class="p">,</span>    <span class="c1"># Max step for translation for IOPT &gt; 0</span>
    <span class="s1">&#39;invcurv&#39;</span><span class="p">,</span>   <span class="c1"># Initial curvature for LBFGS (IOPT = 1)</span>
    <span class="s1">&#39;timestep&#39;</span><span class="p">,</span>   <span class="c1"># Dynamical timestep for IOPT = 3 and IOPT = 7</span>
    <span class="s1">&#39;sdalpha&#39;</span><span class="p">,</span>    <span class="c1"># Ratio between force and step size for IOPT = 4</span>
    <span class="c1"># The next keywords pertain to IOPT = 7 (i.e. FIRE)</span>
    <span class="s1">&#39;ftimemax&#39;</span><span class="p">,</span>   <span class="c1"># Max time step</span>
    <span class="s1">&#39;ftimedec&#39;</span><span class="p">,</span>   <span class="c1"># Factor to dec. dt</span>
    <span class="s1">&#39;ftimeinc&#39;</span><span class="p">,</span>   <span class="c1"># Factor to inc. dt</span>
    <span class="s1">&#39;falpha&#39;</span><span class="p">,</span>     <span class="c1"># Parameter for velocity damping</span>
    <span class="s1">&#39;falphadec&#39;</span><span class="p">,</span>  <span class="c1"># Factor to dec. alpha</span>
    <span class="s1">&#39;clz&#39;</span><span class="p">,</span>        <span class="c1"># electron count for core level shift</span>
    <span class="s1">&#39;vdw_radius&#39;</span><span class="p">,</span>  <span class="c1"># Cutoff radius for Grimme&#39;s DFT-D2 and DFT-D3 and</span>
                   <span class="c1"># Tkatchenko and Scheffler&#39;s DFT-TS dispersion corrections</span>
    <span class="s1">&#39;vdw_scaling&#39;</span><span class="p">,</span>  <span class="c1"># Global scaling parameter for Grimme&#39;s DFT-D2 dispersion</span>
                    <span class="c1"># correction</span>
    <span class="s1">&#39;vdw_d&#39;</span><span class="p">,</span>      <span class="c1"># Global damping parameter for Grimme&#39;s DFT-D2 and Tkatchenko</span>
                  <span class="c1"># and Scheffler&#39;s DFT-TS dispersion corrections</span>
    <span class="s1">&#39;vdw_cnradius&#39;</span><span class="p">,</span>  <span class="c1"># Cutoff radius for calculating coordination number in</span>
                    <span class="c1"># Grimme&#39;s DFT-D3 dispersion correction</span>
    <span class="s1">&#39;vdw_s6&#39;</span><span class="p">,</span>     <span class="c1"># Damping parameter for Grimme&#39;s DFT-D2 and DFT-D3 and</span>
                  <span class="c1"># Tkatchenko and Scheffler&#39;s DFT-TS dispersion corrections</span>
    <span class="s1">&#39;vdw_s8&#39;</span><span class="p">,</span>     <span class="c1"># Damping parameter for Grimme&#39;s DFT-D3 dispersion correction</span>
    <span class="s1">&#39;vdw_sr&#39;</span><span class="p">,</span>     <span class="c1"># Scaling parameter for Grimme&#39;s DFT-D2 and DFT-D3 and</span>
                  <span class="c1"># Tkatchenko and Scheffler&#39;s DFT-TS dispersion correction</span>
    <span class="s1">&#39;vdw_a1&#39;</span><span class="p">,</span>     <span class="c1"># Damping parameter for Grimme&#39;s DFT-D3 dispersion correction</span>
    <span class="s1">&#39;vdw_a2&#39;</span><span class="p">,</span>     <span class="c1"># Damping parameter for Grimme&#39;s DFT-D3 dispersion correction</span>
    <span class="s1">&#39;eb_k&#39;</span><span class="p">,</span>       <span class="c1"># solvent permitivity in Vaspsol</span>
    <span class="s1">&#39;tau&#39;</span><span class="p">,</span>        <span class="c1"># surface tension parameter in Vaspsol</span>
    <span class="s1">&#39;langevin_gamma_l&#39;</span><span class="p">,</span>  <span class="c1"># Friction for lattice degrees of freedom</span>
    <span class="s1">&#39;pmass&#39;</span><span class="p">,</span>      <span class="c1"># Mass for latice degrees of freedom</span>
    <span class="s1">&#39;bparam&#39;</span><span class="p">,</span>     <span class="c1"># B parameter for nonlocal VV10 vdW functional</span>
    <span class="s1">&#39;cparam&#39;</span><span class="p">,</span>     <span class="c1"># C parameter for nonlocal VV10 vdW functional</span>
    <span class="s1">&#39;aldax&#39;</span><span class="p">,</span>      <span class="c1"># Fraction of LDA exchange (for hybrid calculations)</span>
    <span class="s1">&#39;tebeg&#39;</span><span class="p">,</span>      <span class="c1">#</span>
    <span class="s1">&#39;teend&#39;</span><span class="p">,</span>      <span class="c1"># temperature during run</span>
    <span class="s1">&#39;andersen_prob&#39;</span><span class="p">,</span>  <span class="c1"># Probability of collision in Andersen thermostat</span>
    <span class="s1">&#39;apaco&#39;</span><span class="p">,</span>      <span class="c1"># Distance cutoff for pair correlation function calc.</span>
    <span class="s1">&#39;auger_ecblo&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter for Auger calculations</span>
    <span class="s1">&#39;auger_edens&#39;</span><span class="p">,</span>  <span class="c1"># Density of electrons in conduction band</span>
    <span class="s1">&#39;auger_hdens&#39;</span><span class="p">,</span>  <span class="c1"># Density of holes in valence band</span>
    <span class="s1">&#39;auger_efermi&#39;</span><span class="p">,</span>  <span class="c1"># Fixed Fermi level for Auger calculations</span>
    <span class="s1">&#39;auger_evbhi&#39;</span><span class="p">,</span>  <span class="c1"># Upper bound for valence band maximum</span>
    <span class="s1">&#39;auger_ewidth&#39;</span><span class="p">,</span>  <span class="c1"># Half-width of energy window function</span>
    <span class="s1">&#39;auger_occ_fac_eeh&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter for Auger calculations</span>
    <span class="s1">&#39;auger_occ_fac_ehh&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter for Auger calculations</span>
    <span class="s1">&#39;auger_temp&#39;</span><span class="p">,</span>  <span class="c1"># Temperature for Auger calculation</span>
    <span class="s1">&#39;dq&#39;</span><span class="p">,</span>         <span class="c1"># Finite difference displacement magnitude (NMR)</span>
    <span class="s1">&#39;avgap&#39;</span><span class="p">,</span>      <span class="c1"># Average gap (Model GW)</span>
    <span class="s1">&#39;bpotim&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;qrr&#39;</span><span class="p">,</span>        <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;prr&#39;</span><span class="p">,</span>        <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;rcut&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;dvmax&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;bfgsinvcurv&#39;</span><span class="p">,</span>  <span class="c1"># Initial curvature for BFGS (GH patches)</span>
    <span class="s1">&#39;damping&#39;</span><span class="p">,</span>    <span class="c1"># Damping parameter for LBFGS (GH patches)</span>
    <span class="s1">&#39;efirst&#39;</span><span class="p">,</span>     <span class="c1"># Energy of first NEB image (GH patches)</span>
    <span class="s1">&#39;elast&#39;</span><span class="p">,</span>      <span class="c1"># Energy of final NEB image (GH patches)</span>
    <span class="s1">&#39;fmagval&#39;</span><span class="p">,</span>    <span class="c1"># Force magnitude convergence criterion (GH patches)</span>
    <span class="s1">&#39;cmbj&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented MetaGGA parameter</span>
    <span class="s1">&#39;cmbja&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented MetaGGA parameter</span>
    <span class="s1">&#39;cmbjb&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented MetaGGA parameter</span>
    <span class="s1">&#39;sigma_nc_k&#39;</span><span class="p">,</span>  <span class="c1"># Width of ion gaussians (VASPsol)</span>
    <span class="s1">&#39;sigma_k&#39;</span><span class="p">,</span>    <span class="c1"># Width of dielectric cavidty (VASPsol)</span>
    <span class="s1">&#39;nc_k&#39;</span><span class="p">,</span>       <span class="c1"># Cavity turn-on density (VASPsol)</span>
    <span class="s1">&#39;lambda_d_k&#39;</span><span class="p">,</span>  <span class="c1"># Debye screening length (VASPsol)</span>
    <span class="s1">&#39;ediffsol&#39;</span><span class="p">,</span>   <span class="c1"># Tolerance for solvation convergence (VASPsol)</span>
    <span class="s1">&#39;deg_threshold&#39;</span><span class="p">,</span>  <span class="c1"># Degeneracy threshold</span>
    <span class="s1">&#39;omegamin&#39;</span><span class="p">,</span>   <span class="c1"># Minimum frequency for dense freq. grid</span>
    <span class="s1">&#39;omegamax&#39;</span><span class="p">,</span>   <span class="c1"># Maximum frequency for dense freq. grid</span>
    <span class="s1">&#39;rtime&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;wplasma&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;wplasmai&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;dfield&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;omegatl&#39;</span><span class="p">,</span>    <span class="c1"># Maximum frequency for coarse freq. grid</span>
    <span class="s1">&#39;encutgwsoft&#39;</span><span class="p">,</span>  <span class="c1"># Soft energy cutoff for response kernel</span>
    <span class="s1">&#39;encutlf&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;scissor&#39;</span><span class="p">,</span>    <span class="c1"># Scissor correction for GW/BSE calcs</span>
    <span class="s1">&#39;dimer_dist&#39;</span><span class="p">,</span>  <span class="c1"># Distance between dimer images</span>
    <span class="s1">&#39;step_size&#39;</span><span class="p">,</span>  <span class="c1"># Step size for finite difference in dimer calculation</span>
    <span class="s1">&#39;step_max&#39;</span><span class="p">,</span>   <span class="c1"># Maximum step size for dimer calculation</span>
    <span class="s1">&#39;minrot&#39;</span><span class="p">,</span>     <span class="c1"># Minimum rotation allowed in dimer calculation</span>
    <span class="s1">&#39;dummy_mass&#39;</span><span class="p">,</span>  <span class="c1"># Mass of dummy atom(s?)</span>
    <span class="s1">&#39;shaketol&#39;</span><span class="p">,</span>   <span class="c1"># Tolerance for SHAKE algorithm</span>
    <span class="s1">&#39;shaketolsoft&#39;</span><span class="p">,</span>  <span class="c1"># Soft tolerance for SHAKE algorithm</span>
    <span class="s1">&#39;shakesca&#39;</span><span class="p">,</span>   <span class="c1"># Scaling of each step taken in SHAKE algorithm</span>
    <span class="s1">&#39;hills_stride&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented metadynamics parameter</span>
    <span class="s1">&#39;hills_h&#39;</span><span class="p">,</span>    <span class="c1"># Height (in eV) of gaussian bias for metadynamics</span>
    <span class="s1">&#39;hills_w&#39;</span><span class="p">,</span>    <span class="c1"># Width of gaussian bias for metadynamics</span>
    <span class="s1">&#39;hills_k&#39;</span><span class="p">,</span>    <span class="c1"># Force constant coupling dummy&amp;real for metadynamics</span>
    <span class="s1">&#39;hills_m&#39;</span><span class="p">,</span>    <span class="c1"># Mass of dummy particle for use in metadynamics</span>
    <span class="s1">&#39;hills_temperature&#39;</span><span class="p">,</span>  <span class="c1"># Temp. of dummy particle for metadynamics</span>
    <span class="s1">&#39;hills_andersen_prob&#39;</span><span class="p">,</span>  <span class="c1"># Probability of thermostat coll. for metadynamics</span>
    <span class="s1">&#39;hills_sqq&#39;</span><span class="p">,</span>  <span class="c1"># Nose-hoover particle mass for metadynamics</span>
    <span class="s1">&#39;dvvdelta0&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;dvvvnorm0&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;dvvminpotim&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;dvvmaxpotim&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;efermi&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;enchg&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented charge fitting parameter</span>
    <span class="s1">&#39;tau0&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented charge fitting parameter</span>
    <span class="s1">&#39;encut4o&#39;</span><span class="p">,</span>    <span class="c1"># Cutoff energy for 4-center integrals (HF)</span>
    <span class="s1">&#39;param3&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;model_eps0&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;model_alpha&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;qmaxfockae&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;hfscreenc&#39;</span><span class="p">,</span>  <span class="c1"># Range-separated screening length for correlations</span>
    <span class="s1">&#39;hfrcut&#39;</span><span class="p">,</span>     <span class="c1"># Cutoff radius for HF potential kernel</span>
    <span class="s1">&#39;encutae&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter for all-electron density calc.</span>
    <span class="s1">&#39;encutsubrotscf&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented subspace rotation SCF parameter</span>
    <span class="s1">&#39;enini&#39;</span><span class="p">,</span>      <span class="c1"># Cutoff energy for wavefunctions (?)</span>
    <span class="s1">&#39;wc&#39;</span><span class="p">,</span>         <span class="c1"># Undocumented mixing parameter</span>
    <span class="s1">&#39;enmax&#39;</span><span class="p">,</span>      <span class="c1"># Cutoff energy for wavefunctions (?)</span>
    <span class="s1">&#39;scalee&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;eref&#39;</span><span class="p">,</span>       <span class="c1"># Reference energy</span>
    <span class="s1">&#39;epsilon&#39;</span><span class="p">,</span>    <span class="c1"># Dielectric constant of bulk charged cells</span>
    <span class="s1">&#39;rcmix&#39;</span><span class="p">,</span>      <span class="c1"># Mixing parameter for core density in rel. core calcs.</span>
    <span class="s1">&#39;esemicore&#39;</span><span class="p">,</span>  <span class="c1"># Energetic lower bound for states considered &quot;semicore&quot;</span>
    <span class="s1">&#39;external_pressure&#39;</span><span class="p">,</span>  <span class="c1"># Pressure for NPT calcs., equivalent to PSTRESS</span>
    <span class="s1">&#39;lj_radius&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lj_epsilon&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lj_sigma&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;mbd_beta&#39;</span><span class="p">,</span>   <span class="c1"># TS MBD vdW correction damping parameter</span>
    <span class="s1">&#39;scsrad&#39;</span><span class="p">,</span>     <span class="c1"># Cutoff radius for dipole-dipole interaction tensor in SCS</span>
    <span class="s1">&#39;hitoler&#39;</span><span class="p">,</span>    <span class="c1"># Iterative Hirschfeld partitioning tolerance</span>
    <span class="s1">&#39;lambda&#39;</span><span class="p">,</span>     <span class="c1"># &quot;Spring constant&quot; for magmom constraint calcs.</span>
    <span class="s1">&#39;kproj_threshold&#39;</span><span class="p">,</span>  <span class="c1"># Threshold for k-point projection scheme</span>
    <span class="s1">&#39;maxpwamp&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;vcutoff&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;mdtemp&#39;</span><span class="p">,</span>     <span class="c1"># Temperature for AIMD</span>
    <span class="s1">&#39;mdgamma&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented AIMD parameter</span>
    <span class="s1">&#39;mdalpha&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented AIMD parameter</span>
    <span class="s1">&#39;ofield_kappa&#39;</span><span class="p">,</span>  <span class="c1"># Bias potential strength for interface pinning method</span>
    <span class="s1">&#39;ofield_q6_near&#39;</span><span class="p">,</span>  <span class="c1"># Steinhardt-Nelson Q6 parameters for interface pinning</span>
    <span class="s1">&#39;ofield_q6_far&#39;</span><span class="p">,</span>  <span class="c1"># Steinhardt-Nelson Q6 parameters for interface pinning</span>
    <span class="s1">&#39;ofield_a&#39;</span><span class="p">,</span>   <span class="c1"># Target order parameter for interface pinning method</span>
    <span class="s1">&#39;pthreshold&#39;</span><span class="p">,</span>  <span class="c1"># Don&#39;t print timings for routines faster than this value</span>
    <span class="s1">&#39;qltol&#39;</span><span class="p">,</span>      <span class="c1"># Eigenvalue tolerance for Lanczos iteration (instanton)</span>
    <span class="s1">&#39;qdr&#39;</span><span class="p">,</span>        <span class="c1"># Step size for building Lanczos matrix &amp; CG (instanton)</span>
    <span class="s1">&#39;qmaxmove&#39;</span><span class="p">,</span>   <span class="c1"># Max step size (instanton)</span>
    <span class="s1">&#39;qdt&#39;</span><span class="p">,</span>        <span class="c1"># Timestep for quickmin minimization (instanton)</span>
    <span class="s1">&#39;qtpz&#39;</span><span class="p">,</span>       <span class="c1"># Temperature (instanton)</span>
    <span class="s1">&#39;qftol&#39;</span><span class="p">,</span>      <span class="c1"># Tolerance (instanton)</span>
<span class="p">]</span>

<span class="n">exp_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ediff&#39;</span><span class="p">,</span>      <span class="c1"># stopping-criterion for electronic upd.</span>
    <span class="s1">&#39;ediffg&#39;</span><span class="p">,</span>     <span class="c1"># stopping-criterion for ionic upd.</span>
    <span class="s1">&#39;symprec&#39;</span><span class="p">,</span>    <span class="c1"># precession in symmetry routines</span>
    <span class="c1"># The next keywords pertain to the VTST add-ons from Graeme Henkelman&#39;s</span>
    <span class="c1"># group at UT Austin</span>
    <span class="s1">&#39;fdstep&#39;</span><span class="p">,</span>     <span class="c1"># Finite diference step for IOPT = 1 or 2</span>
<span class="p">]</span>

<span class="n">string_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;algo&#39;</span><span class="p">,</span>       <span class="c1"># algorithm: Normal (Davidson) | Fast | Very_Fast (RMM-DIIS)</span>
    <span class="s1">&#39;gga&#39;</span><span class="p">,</span>        <span class="c1"># xc-type: PW PB LM or 91 (LDA if not set)</span>
    <span class="s1">&#39;metagga&#39;</span><span class="p">,</span>    <span class="c1">#</span>
    <span class="s1">&#39;prec&#39;</span><span class="p">,</span>       <span class="c1"># Precission of calculation (Low, Normal, Accurate)</span>
    <span class="s1">&#39;system&#39;</span><span class="p">,</span>     <span class="c1"># name of System</span>
    <span class="s1">&#39;precfock&#39;</span><span class="p">,</span>    <span class="c1"># FFT grid in the HF related routines</span>
    <span class="s1">&#39;radeq&#39;</span><span class="p">,</span>      <span class="c1"># Which type of radial equations to use for rel. core calcs.</span>
    <span class="s1">&#39;localized_basis&#39;</span><span class="p">,</span>  <span class="c1"># Basis to use in CRPA</span>
    <span class="s1">&#39;proutine&#39;</span><span class="p">,</span>   <span class="c1"># Select profiling routine</span>
<span class="p">]</span>

<span class="n">int_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ialgo&#39;</span><span class="p">,</span>      <span class="c1"># algorithm: use only 8 (CG) or 48 (RMM-DIIS)</span>
    <span class="s1">&#39;ibrion&#39;</span><span class="p">,</span>     <span class="c1"># ionic relaxation: 0-MD 1-quasi-New 2-CG</span>
    <span class="s1">&#39;icharg&#39;</span><span class="p">,</span>     <span class="c1"># charge: 0-WAVECAR 1-CHGCAR 2-atom 10-const</span>
    <span class="s1">&#39;idipol&#39;</span><span class="p">,</span>     <span class="c1"># monopol/dipol and quadropole corrections</span>
    <span class="s1">&#39;images&#39;</span><span class="p">,</span>     <span class="c1"># number of images for NEB calculation</span>
    <span class="s1">&#39;iniwav&#39;</span><span class="p">,</span>     <span class="c1"># initial electr wf. : 0-lowe 1-rand</span>
    <span class="s1">&#39;isif&#39;</span><span class="p">,</span>       <span class="c1"># calculate stress and what to relax</span>
    <span class="s1">&#39;ismear&#39;</span><span class="p">,</span>     <span class="c1"># part. occupancies: -5 Blochl -4-tet -1-fermi 0-gaus &gt;0 MP</span>
    <span class="s1">&#39;ispin&#39;</span><span class="p">,</span>      <span class="c1"># spin-polarized calculation</span>
    <span class="s1">&#39;istart&#39;</span><span class="p">,</span>     <span class="c1"># startjob: 0-new 1-cont 2-samecut</span>
    <span class="s1">&#39;isym&#39;</span><span class="p">,</span>       <span class="c1"># symmetry: 0-nonsym 1-usesym 2-usePAWsym</span>
    <span class="s1">&#39;iwavpr&#39;</span><span class="p">,</span>     <span class="c1"># prediction of wf.: 0-non 1-charg 2-wave 3-comb</span>
    <span class="s1">&#39;kpar&#39;</span><span class="p">,</span>       <span class="c1"># k-point parallelization paramater</span>
    <span class="s1">&#39;ldauprint&#39;</span><span class="p">,</span>  <span class="c1"># 0-silent, 1-occ. matrix written to OUTCAR, 2-1+pot. matrix</span>
                  <span class="c1"># written</span>
    <span class="s1">&#39;ldautype&#39;</span><span class="p">,</span>   <span class="c1"># L(S)DA+U: 1-Liechtenstein 2-Dudarev 4-Liechtenstein(LDAU)</span>
    <span class="s1">&#39;lmaxmix&#39;</span><span class="p">,</span>    <span class="c1">#</span>
    <span class="s1">&#39;lorbit&#39;</span><span class="p">,</span>     <span class="c1"># create PROOUT</span>
    <span class="s1">&#39;maxmix&#39;</span><span class="p">,</span>     <span class="c1">#</span>
    <span class="s1">&#39;ngx&#39;</span><span class="p">,</span>        <span class="c1"># FFT mesh for wavefunctions, x</span>
    <span class="s1">&#39;ngxf&#39;</span><span class="p">,</span>       <span class="c1"># FFT mesh for charges x</span>
    <span class="s1">&#39;ngy&#39;</span><span class="p">,</span>        <span class="c1"># FFT mesh for wavefunctions, y</span>
    <span class="s1">&#39;ngyf&#39;</span><span class="p">,</span>       <span class="c1"># FFT mesh for charges y</span>
    <span class="s1">&#39;ngz&#39;</span><span class="p">,</span>        <span class="c1"># FFT mesh for wavefunctions, z</span>
    <span class="s1">&#39;ngzf&#39;</span><span class="p">,</span>       <span class="c1"># FFT mesh for charges z</span>
    <span class="s1">&#39;nbands&#39;</span><span class="p">,</span>     <span class="c1"># Number of bands</span>
    <span class="s1">&#39;nblk&#39;</span><span class="p">,</span>       <span class="c1"># blocking for some BLAS calls (Sec. 6.5)</span>
    <span class="s1">&#39;nbmod&#39;</span><span class="p">,</span>      <span class="c1"># specifies mode for partial charge calculation</span>
    <span class="s1">&#39;nelm&#39;</span><span class="p">,</span>       <span class="c1"># nr. of electronic steps (default 60)</span>
    <span class="s1">&#39;nelmdl&#39;</span><span class="p">,</span>     <span class="c1"># nr. of initial electronic steps</span>
    <span class="s1">&#39;nelmin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nfree&#39;</span><span class="p">,</span>      <span class="c1"># number of steps per DOF when calculting Hessian using</span>
                  <span class="c1"># finite differences</span>
    <span class="s1">&#39;nkred&#39;</span><span class="p">,</span>      <span class="c1"># define sub grid of q-points for HF with</span>
                  <span class="c1"># nkredx=nkredy=nkredz</span>
    <span class="s1">&#39;nkredx&#39;</span><span class="p">,</span>      <span class="c1"># define sub grid of q-points in x direction for HF</span>
    <span class="s1">&#39;nkredy&#39;</span><span class="p">,</span>      <span class="c1"># define sub grid of q-points in y direction for HF</span>
    <span class="s1">&#39;nkredz&#39;</span><span class="p">,</span>      <span class="c1"># define sub grid of q-points in z direction for HF</span>
    <span class="s1">&#39;nomega&#39;</span><span class="p">,</span>     <span class="c1"># number of frequency points</span>
    <span class="s1">&#39;nomegar&#39;</span><span class="p">,</span>    <span class="c1"># number of frequency points on real axis</span>
    <span class="s1">&#39;npar&#39;</span><span class="p">,</span>       <span class="c1"># parallelization over bands</span>
    <span class="s1">&#39;nsim&#39;</span><span class="p">,</span>       <span class="c1"># evaluate NSIM bands simultaneously if using RMM-DIIS</span>
    <span class="s1">&#39;nsw&#39;</span><span class="p">,</span>        <span class="c1"># number of steps for ionic upd.</span>
    <span class="s1">&#39;nupdown&#39;</span><span class="p">,</span>    <span class="c1"># fix spin moment to specified value</span>
    <span class="s1">&#39;nwrite&#39;</span><span class="p">,</span>     <span class="c1"># verbosity write-flag (how much is written)</span>
    <span class="s1">&#39;vdwgr&#39;</span><span class="p">,</span>      <span class="c1"># extra keyword for Andris program</span>
    <span class="s1">&#39;vdwrn&#39;</span><span class="p">,</span>      <span class="c1"># extra keyword for Andris program</span>
    <span class="s1">&#39;voskown&#39;</span><span class="p">,</span>    <span class="c1"># use Vosko, Wilk, Nusair interpolation</span>
    <span class="c1"># The next keywords pertain to the VTST add-ons from Graeme Henkelman&#39;s</span>
    <span class="c1"># group at UT Austin</span>
    <span class="s1">&#39;ichain&#39;</span><span class="p">,</span>     <span class="c1"># Flag for controlling which method is being used (0=NEB,</span>
                  <span class="c1"># 1=DynMat, 2=Dimer, 3=Lanczos) if ichain &gt; 3, then both</span>
                  <span class="c1"># IBRION and POTIM are automatically set in the INCAR file</span>
    <span class="s1">&#39;iopt&#39;</span><span class="p">,</span>       <span class="c1"># Controls which optimizer to use.  for iopt &gt; 0, ibrion = 3</span>
                  <span class="c1"># and potim = 0.0</span>
    <span class="s1">&#39;snl&#39;</span><span class="p">,</span>        <span class="c1"># Maximum dimentionality of the Lanczos matrix</span>
    <span class="s1">&#39;lbfgsmem&#39;</span><span class="p">,</span>   <span class="c1"># Steps saved for inverse Hessian for IOPT = 1 (LBFGS)</span>
    <span class="s1">&#39;fnmin&#39;</span><span class="p">,</span>      <span class="c1"># Max iter. before adjusting dt and alpha for IOPT = 7 (FIRE)</span>
    <span class="s1">&#39;icorelevel&#39;</span><span class="p">,</span>  <span class="c1"># core level shifts</span>
    <span class="s1">&#39;clnt&#39;</span><span class="p">,</span>       <span class="c1"># species index</span>
    <span class="s1">&#39;cln&#39;</span><span class="p">,</span>        <span class="c1"># main quantum number of excited core electron</span>
    <span class="s1">&#39;cll&#39;</span><span class="p">,</span>        <span class="c1"># l quantum number of excited core electron</span>
    <span class="s1">&#39;ivdw&#39;</span><span class="p">,</span>       <span class="c1"># Choose which dispersion correction method to use</span>
    <span class="s1">&#39;nbandsgw&#39;</span><span class="p">,</span>   <span class="c1"># Number of bands for GW</span>
    <span class="s1">&#39;nbandso&#39;</span><span class="p">,</span>    <span class="c1"># Number of occupied bands for electron-hole treatment</span>
    <span class="s1">&#39;nbandsv&#39;</span><span class="p">,</span>    <span class="c1"># Number of virtual bands for electron-hole treatment</span>
    <span class="s1">&#39;ncore&#39;</span><span class="p">,</span>      <span class="c1"># Number of cores per band, equal to number of cores divided</span>
                  <span class="c1"># by npar</span>
    <span class="s1">&#39;mdalgo&#39;</span><span class="p">,</span>     <span class="c1"># Determines which MD method of Tomas Bucko to use</span>
    <span class="s1">&#39;nedos&#39;</span><span class="p">,</span>      <span class="c1"># Number of grid points in DOS</span>
    <span class="s1">&#39;turbo&#39;</span><span class="p">,</span>      <span class="c1"># Ewald, 0 = Normal, 1 = PME</span>
    <span class="s1">&#39;omegapar&#39;</span><span class="p">,</span>   <span class="c1"># Number of groups for response function calc.</span>
    <span class="s1">&#39;taupar&#39;</span><span class="p">,</span>     <span class="c1"># Number of groups in real time for response function calc.</span>
    <span class="s1">&#39;antires&#39;</span><span class="p">,</span>    <span class="c1"># How to treat antiresonant part of response function</span>
    <span class="s1">&#39;magatom&#39;</span><span class="p">,</span>    <span class="c1"># Index of atom at which to place magnetic field (NMR)</span>
    <span class="s1">&#39;jatom&#39;</span><span class="p">,</span>      <span class="c1"># Index of atom at which magnetic moment is evaluated (NMR)</span>
    <span class="s1">&#39;ichibare&#39;</span><span class="p">,</span>   <span class="c1"># chi_bare stencil size (NMR)</span>
    <span class="s1">&#39;nbas&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;rmds&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;ilbfgsmem&#39;</span><span class="p">,</span>  <span class="c1"># Number of histories to store for LBFGS (GH patches)</span>
    <span class="s1">&#39;vcaimages&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter (GH patches)</span>
    <span class="s1">&#39;ntemper&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented subspace diagonalization param. (GH patches)</span>
    <span class="s1">&#39;ncshmem&#39;</span><span class="p">,</span>    <span class="c1"># Share memory between this many cores on each process</span>
    <span class="s1">&#39;lmaxtau&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented MetaGGA parameter (prob. max ang.mom. for tau)</span>
    <span class="s1">&#39;kinter&#39;</span><span class="p">,</span>     <span class="c1"># Additional finer grid (?)</span>
    <span class="s1">&#39;ibse&#39;</span><span class="p">,</span>       <span class="c1"># Type of BSE calculation</span>
    <span class="s1">&#39;nbseeig&#39;</span><span class="p">,</span>    <span class="c1"># Number of BSE wfns to write</span>
    <span class="s1">&#39;naturalo&#39;</span><span class="p">,</span>   <span class="c1"># Use NATURALO (?)</span>
    <span class="s1">&#39;nbandsexact&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nbandsgwlow&#39;</span><span class="p">,</span>  <span class="c1"># Number of bands for which shifts are calculated</span>
    <span class="s1">&#39;nbandslf&#39;</span><span class="p">,</span>   <span class="c1"># Number of bands included in local field effect calc.</span>
    <span class="s1">&#39;omegagrid&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;telescope&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;maxmem&#39;</span><span class="p">,</span>     <span class="c1"># Amount of memory to allocate per core in MB</span>
    <span class="s1">&#39;nelmhf&#39;</span><span class="p">,</span>     <span class="c1"># Number of iterations for HF part (GW)</span>
    <span class="s1">&#39;dim&#39;</span><span class="p">,</span>        <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nkredlf&#39;</span><span class="p">,</span>    <span class="c1"># Reduce k-points for local field effects</span>
    <span class="s1">&#39;nkredlfx&#39;</span><span class="p">,</span>   <span class="c1"># Reduce k-points for local field effects in X</span>
    <span class="s1">&#39;nkredlfy&#39;</span><span class="p">,</span>   <span class="c1"># Reduce k-points for local field effects in Y</span>
    <span class="s1">&#39;nkredlfz&#39;</span><span class="p">,</span>   <span class="c1"># Reduce k-points for local field effects in Z</span>
    <span class="s1">&#39;lmaxmp2&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;switch&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented dimer parameter</span>
    <span class="s1">&#39;findiff&#39;</span><span class="p">,</span>    <span class="c1"># Use forward (1) or central (2) finite difference for dimer</span>
    <span class="s1">&#39;engine&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented dimer parameter</span>
    <span class="s1">&#39;restartcg&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented dimer parameter</span>
    <span class="s1">&#39;thermostat&#39;</span><span class="p">,</span>  <span class="c1"># Deprecated parameter for selecting MD method (use MDALGO)</span>
    <span class="s1">&#39;scaling&#39;</span><span class="p">,</span>    <span class="c1"># After how many steps velocities should be rescaled</span>
    <span class="s1">&#39;shakemaxiter&#39;</span><span class="p">,</span>  <span class="c1"># Maximum # of iterations in SHAKE algorithm</span>
    <span class="s1">&#39;equi_regime&#39;</span><span class="p">,</span>  <span class="c1"># Number of steps to equilibrate for</span>
    <span class="s1">&#39;hills_bin&#39;</span><span class="p">,</span>  <span class="c1"># Update metadynamics bias after this many steps</span>
    <span class="s1">&#39;hills_maxstride&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented metadynamics parameter</span>
    <span class="s1">&#39;dvvehistory&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ipead&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ngaus&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented charge fitting parameter</span>
    <span class="s1">&#39;exxoep&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;fourorbit&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;model_gw&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;hflmax&#39;</span><span class="p">,</span>     <span class="c1"># Maximum L quantum number for HF calculation</span>
    <span class="s1">&#39;lmaxfock&#39;</span><span class="p">,</span>   <span class="c1"># Maximum L quantum number for HF calc. (same as above)</span>
    <span class="s1">&#39;lmaxfockae&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;nmaxfockae&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;nblock_fock&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;idiot&#39;</span><span class="p">,</span>      <span class="c1"># Determines which warnings/errors to print</span>
    <span class="s1">&#39;nrmm&#39;</span><span class="p">,</span>       <span class="c1"># Number of RMM-DIIS iterations</span>
    <span class="s1">&#39;mremove&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented mixing parameter</span>
    <span class="s1">&#39;inimix&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented mixing parameter</span>
    <span class="s1">&#39;mixpre&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented mixing parameter</span>
    <span class="s1">&#39;nelmall&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nblock&#39;</span><span class="p">,</span>     <span class="c1"># How frequently to write data</span>
    <span class="s1">&#39;kblock&#39;</span><span class="p">,</span>     <span class="c1"># How frequently to write data</span>
    <span class="s1">&#39;npaco&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented pair correlation function parameter</span>
    <span class="s1">&#39;lmaxpaw&#39;</span><span class="p">,</span>    <span class="c1"># Max L quantum number for on-site charge expansion</span>
    <span class="s1">&#39;irestart&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nreboot&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nmin&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nlspline&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ispecial&#39;</span><span class="p">,</span>   <span class="c1"># &quot;Select undocumented and unsupported special features&quot;</span>
    <span class="s1">&#39;rcrep&#39;</span><span class="p">,</span>      <span class="c1"># Number of steps between printing relaxed core info</span>
    <span class="s1">&#39;rcndl&#39;</span><span class="p">,</span>      <span class="c1"># Wait this many steps before updating core density</span>
    <span class="s1">&#39;rcstrd&#39;</span><span class="p">,</span>     <span class="c1"># Relax core density after this many SCF steps</span>
    <span class="s1">&#39;vdw_idampf&#39;</span><span class="p">,</span>  <span class="c1"># Select type of damping function for TS vdW</span>
    <span class="s1">&#39;i_constrained_m&#39;</span><span class="p">,</span>  <span class="c1"># Select type of magmom. constraint to use</span>
    <span class="s1">&#39;igpar&#39;</span><span class="p">,</span>      <span class="c1"># &quot;G parallel&quot; direction for Berry phase calculation</span>
    <span class="s1">&#39;nppstr&#39;</span><span class="p">,</span>     <span class="c1"># Number of kpts in &quot;igpar&#39; direction for Berry phase calc.</span>
    <span class="s1">&#39;nbands_out&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented QP parameter</span>
    <span class="s1">&#39;kpts_out&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented QP parameter</span>
    <span class="s1">&#39;isp_out&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented QP parameter</span>
    <span class="s1">&#39;nomega_out&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented QP parameter</span>
    <span class="s1">&#39;maxiter_ft&#39;</span><span class="p">,</span>  <span class="c1"># Max iterations for sloppy Remez algorithm</span>
    <span class="s1">&#39;nmaxalt&#39;</span><span class="p">,</span>    <span class="c1"># Max sample points for alternant in Remez algorithms</span>
    <span class="s1">&#39;itmaxlsq&#39;</span><span class="p">,</span>   <span class="c1"># Max iterations in LSQ search algorithm</span>
    <span class="s1">&#39;ndatalsq&#39;</span><span class="p">,</span>   <span class="c1"># Number of sample points for LSQ search algorithm</span>
    <span class="s1">&#39;ncore_in_image1&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;kimages&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ncores_per_band&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;maxlie&#39;</span><span class="p">,</span>     <span class="c1"># Max iterations in CRPA diagonalization routine</span>
    <span class="s1">&#39;ncrpalow&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented CRPA parameter</span>
    <span class="s1">&#39;ncrpahigh&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented CRPA parameter</span>
    <span class="s1">&#39;nwlow&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nwhigh&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;nkopt&#39;</span><span class="p">,</span>      <span class="c1"># Number of k-points to include in Optics calculation</span>
    <span class="s1">&#39;nkoffopt&#39;</span><span class="p">,</span>   <span class="c1"># K-point &quot;counter offset&quot; for Optics</span>
    <span class="s1">&#39;nbvalopt&#39;</span><span class="p">,</span>   <span class="c1"># Number of valence bands to write in OPTICS file</span>
    <span class="s1">&#39;nbconopt&#39;</span><span class="p">,</span>   <span class="c1"># Number of conduction bands to write in OPTICS file</span>
    <span class="s1">&#39;plevel&#39;</span><span class="p">,</span>     <span class="c1"># No timings for routines with &quot;level&quot; higher than this</span>
    <span class="s1">&#39;qnl&#39;</span><span class="p">,</span>        <span class="c1"># Lanczos matrix size (instanton)</span>
<span class="p">]</span>

<span class="n">bool_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;addgrid&#39;</span><span class="p">,</span>    <span class="c1"># finer grid for augmentation charge density</span>
    <span class="s1">&#39;kgamma&#39;</span><span class="p">,</span>     <span class="c1"># The generated kpoint grid (from KSPACING) is either</span>
                  <span class="c1"># centred at the $\Gamma$</span>
                  <span class="c1"># point (e.g. includes the $\Gamma$ point)</span>
                  <span class="c1"># (KGAMMA=.TRUE.)</span>
    <span class="s1">&#39;laechg&#39;</span><span class="p">,</span>     <span class="c1"># write AECCAR0/AECCAR1/AECCAR2</span>
    <span class="s1">&#39;lasph&#39;</span><span class="p">,</span>      <span class="c1"># non-spherical contributions to XC energy (and pot for</span>
                  <span class="c1"># VASP.5.X)</span>
    <span class="s1">&#39;lasync&#39;</span><span class="p">,</span>     <span class="c1"># overlap communcation with calculations</span>
    <span class="s1">&#39;lcharg&#39;</span><span class="p">,</span>     <span class="c1">#</span>
    <span class="s1">&#39;lcorr&#39;</span><span class="p">,</span>      <span class="c1"># Harris-correction to forces</span>
    <span class="s1">&#39;ldau&#39;</span><span class="p">,</span>       <span class="c1"># L(S)DA+U</span>
    <span class="s1">&#39;ldiag&#39;</span><span class="p">,</span>      <span class="c1"># algorithm: perform sub space rotation</span>
    <span class="s1">&#39;ldipol&#39;</span><span class="p">,</span>     <span class="c1"># potential correction mode</span>
    <span class="s1">&#39;lelf&#39;</span><span class="p">,</span>       <span class="c1"># create ELFCAR</span>
    <span class="s1">&#39;lepsilon&#39;</span><span class="p">,</span>   <span class="c1"># enables to calculate and to print the BEC tensors</span>
    <span class="s1">&#39;lhfcalc&#39;</span><span class="p">,</span>    <span class="c1"># switch to turn on Hartree Fock calculations</span>
    <span class="s1">&#39;loptics&#39;</span><span class="p">,</span>    <span class="c1"># calculate the frequency dependent dielectric matrix</span>
    <span class="s1">&#39;lpard&#39;</span><span class="p">,</span>      <span class="c1"># evaluate partial (band and/or k-point) decomposed charge</span>
                  <span class="c1"># density</span>
    <span class="s1">&#39;lplane&#39;</span><span class="p">,</span>     <span class="c1"># parallelisation over the FFT grid</span>
    <span class="s1">&#39;lscalapack&#39;</span><span class="p">,</span>  <span class="c1"># switch off scaLAPACK</span>
    <span class="s1">&#39;lscalu&#39;</span><span class="p">,</span>     <span class="c1"># switch of LU decomposition</span>
    <span class="s1">&#39;lsepb&#39;</span><span class="p">,</span>      <span class="c1"># write out partial charge of each band separately?</span>
    <span class="s1">&#39;lsepk&#39;</span><span class="p">,</span>      <span class="c1"># write out partial charge of each k-point separately?</span>
    <span class="s1">&#39;lthomas&#39;</span><span class="p">,</span>    <span class="c1">#</span>
    <span class="s1">&#39;luse_vdw&#39;</span><span class="p">,</span>   <span class="c1"># Invoke vdW-DF implementation by Klimes et. al</span>
    <span class="s1">&#39;lvdw&#39;</span><span class="p">,</span>   <span class="c1"># Invoke DFT-D2 method of Grimme</span>
    <span class="s1">&#39;lvhar&#39;</span><span class="p">,</span>      <span class="c1"># write Hartree potential to LOCPOT (vasp 5.x)</span>
    <span class="s1">&#39;lvtot&#39;</span><span class="p">,</span>      <span class="c1"># create WAVECAR/CHGCAR/LOCPOT</span>
    <span class="s1">&#39;lwave&#39;</span><span class="p">,</span>      <span class="c1">#</span>
    <span class="c1"># The next keywords pertain to the VTST add-ons from Graeme Henkelman&#39;s</span>
    <span class="c1"># group at UT Austin</span>
    <span class="s1">&#39;lclimb&#39;</span><span class="p">,</span>     <span class="c1"># Turn on CI-NEB</span>
    <span class="s1">&#39;ltangentold&#39;</span><span class="p">,</span>  <span class="c1"># Old central difference tangent</span>
    <span class="s1">&#39;ldneb&#39;</span><span class="p">,</span>      <span class="c1"># Turn on modified double nudging</span>
    <span class="s1">&#39;lnebcell&#39;</span><span class="p">,</span>   <span class="c1"># Turn on SS-NEB</span>
    <span class="s1">&#39;lglobal&#39;</span><span class="p">,</span>    <span class="c1"># Optmize NEB globally for LBFGS (IOPT = 1)</span>
    <span class="s1">&#39;llineopt&#39;</span><span class="p">,</span>   <span class="c1"># Use force based line minimizer for translation (IOPT = 1)</span>
    <span class="s1">&#39;lbeefens&#39;</span><span class="p">,</span>   <span class="c1"># Switch on print of BEE energy contributions in OUTCAR</span>
    <span class="s1">&#39;lbeefbas&#39;</span><span class="p">,</span>   <span class="c1"># Switch off print of all BEEs in OUTCAR</span>
    <span class="s1">&#39;lcalcpol&#39;</span><span class="p">,</span>   <span class="c1"># macroscopic polarization (vasp5.2). &#39;lcalceps&#39;</span>
    <span class="s1">&#39;lcalceps&#39;</span><span class="p">,</span>   <span class="c1"># Macroscopic dielectric properties and Born effective charge</span>
                  <span class="c1"># tensors (vasp 5.2)</span>

    <span class="s1">&#39;lvdw&#39;</span><span class="p">,</span>       <span class="c1"># Turns on dispersion correction</span>
    <span class="s1">&#39;lvdw_ewald&#39;</span><span class="p">,</span>  <span class="c1"># Turns on Ewald summation for Grimme&#39;s DFT-D2 and</span>
                   <span class="c1"># Tkatchenko and Scheffler&#39;s DFT-TS dispersion correction</span>
    <span class="s1">&#39;lspectral&#39;</span><span class="p">,</span>  <span class="c1"># Use the spectral method to calculate independent particle</span>
                  <span class="c1"># polarizability</span>
    <span class="s1">&#39;lrpa&#39;</span><span class="p">,</span>       <span class="c1"># Include local field effects on the Hartree level only</span>
    <span class="s1">&#39;lwannier90&#39;</span><span class="p">,</span>  <span class="c1"># Switches on the interface between VASP and WANNIER90</span>
    <span class="s1">&#39;lsorbit&#39;</span><span class="p">,</span>    <span class="c1"># Enable spin-orbit coupling</span>
    <span class="s1">&#39;lsol&#39;</span><span class="p">,</span>       <span class="c1"># turn on solvation for Vaspsol</span>
    <span class="s1">&#39;lautoscale&#39;</span><span class="p">,</span>  <span class="c1"># automatically calculate inverse curvature for VTST LBFGS</span>
    <span class="s1">&#39;interactive&#39;</span><span class="p">,</span>  <span class="c1"># Enables interactive calculation for VaspInteractive</span>
    <span class="s1">&#39;lauger&#39;</span><span class="p">,</span>      <span class="c1"># Perform Auger calculation (Auger)</span>
    <span class="s1">&#39;lauger_eeh&#39;</span><span class="p">,</span>  <span class="c1"># Calculate EEH processes (Auger)</span>
    <span class="s1">&#39;lauger_ehh&#39;</span><span class="p">,</span>  <span class="c1"># Calculate EHH processes (Auger)</span>
    <span class="s1">&#39;lauger_collect&#39;</span><span class="p">,</span>  <span class="c1"># Collect wfns before looping over k-points (Auger)</span>
    <span class="s1">&#39;lauger_dhdk&#39;</span><span class="p">,</span>  <span class="c1"># Auto-determine E. window width from E. derivs. (Auger)</span>
    <span class="s1">&#39;lauger_jit&#39;</span><span class="p">,</span>  <span class="c1"># Distribute wavefunctions for k1-k4 (Auger)</span>
    <span class="s1">&#39;orbitalmag&#39;</span><span class="p">,</span>  <span class="c1"># Enable orbital magnetization (NMR)</span>
    <span class="s1">&#39;lchimag&#39;</span><span class="p">,</span>    <span class="c1"># Use linear response for shielding tensor (NMR)</span>
    <span class="s1">&#39;lwrtcur&#39;</span><span class="p">,</span>    <span class="c1"># Write response of current to mag. field to file (NMR)</span>
    <span class="s1">&#39;lnmr_sym_red&#39;</span><span class="p">,</span>  <span class="c1"># Reduce symmetry for finite difference (NMR)</span>
    <span class="s1">&#39;lzora&#39;</span><span class="p">,</span>      <span class="c1"># Use ZORA approximation in linear-response NMR (NMR)</span>
    <span class="s1">&#39;lbone&#39;</span><span class="p">,</span>      <span class="c1"># Use B-component in AE one-center terms for LR NMR (NMR)</span>
    <span class="s1">&#39;lmagbloch&#39;</span><span class="p">,</span>  <span class="c1"># Use Bloch summations to obtain orbital magnetization (NMR)</span>
    <span class="s1">&#39;lgauge&#39;</span><span class="p">,</span>     <span class="c1"># Use gauge transformation for zero moment terms (NMR)</span>
    <span class="s1">&#39;lbfconst&#39;</span><span class="p">,</span>   <span class="c1"># Use constant B-field with sawtooth vector potential (NMR)</span>
    <span class="s1">&#39;nucind&#39;</span><span class="p">,</span>     <span class="c1"># Use nuclear independent calculation (NMR)</span>
    <span class="s1">&#39;lnicsall&#39;</span><span class="p">,</span>   <span class="c1"># Use all grid points for &#39;nucind&#39; calculation (NMR)</span>
    <span class="s1">&#39;llraug&#39;</span><span class="p">,</span>     <span class="c1"># Use two-center corrections for induced B-field (NMR)</span>
    <span class="s1">&#39;lbbm&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;lnoncollinear&#39;</span><span class="p">,</span>  <span class="c1"># Do non-collinear spin polarized calculation</span>
    <span class="s1">&#39;bfgsdfp&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented BFGS parameter (GH patches)</span>
    <span class="s1">&#39;linemin&#39;</span><span class="p">,</span>    <span class="c1"># Use line minimization (GH patches)</span>
    <span class="s1">&#39;ldneborg&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented NEB parameter (GH patches)</span>
    <span class="s1">&#39;dseed&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented dimer parameter (GH patches)</span>
    <span class="s1">&#39;linteract&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter (GH patches)</span>
    <span class="s1">&#39;lmpmd&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter (GH patches)</span>
    <span class="s1">&#39;ltwodim&#39;</span><span class="p">,</span>    <span class="c1"># Makes stress tensor two-dimensional (GH patches)</span>
    <span class="s1">&#39;fmagflag&#39;</span><span class="p">,</span>   <span class="c1"># Use force magnitude as convergence criterion (GH patches)</span>
    <span class="s1">&#39;ltemper&#39;</span><span class="p">,</span>    <span class="c1"># Use subspace diagonalization (?) (GH patches)</span>
    <span class="s1">&#39;qmflag&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented FIRE parameter (GH patches)</span>
    <span class="s1">&#39;lmixtau&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented MetaGGA parameter</span>
    <span class="s1">&#39;ljdftx&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented VASPsol parameter (VASPsol)</span>
    <span class="s1">&#39;lrhob&#39;</span><span class="p">,</span>      <span class="c1"># Write the bound charge density (VASPsol)</span>
    <span class="s1">&#39;lrhoion&#39;</span><span class="p">,</span>    <span class="c1"># Write the ionic charge density (VASPsol)</span>
    <span class="s1">&#39;lnabla&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;linterfast&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate in K using linear response routines</span>
    <span class="s1">&#39;lvel&#39;</span><span class="p">,</span>       <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lrpaforce&#39;</span><span class="p">,</span>  <span class="c1"># Calculate RPA forces</span>
    <span class="s1">&#39;lhartree&#39;</span><span class="p">,</span>   <span class="c1"># Use IP approx. in BSE (testing only)</span>
    <span class="s1">&#39;ladder&#39;</span><span class="p">,</span>     <span class="c1"># Use ladder diagrams</span>
    <span class="s1">&#39;lfxc&#39;</span><span class="p">,</span>       <span class="c1"># Use approximate ladder diagrams</span>
    <span class="s1">&#39;lrsrpa&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lsingles&#39;</span><span class="p">,</span>   <span class="c1"># Calculate HF singles</span>
    <span class="s1">&#39;lfermigw&#39;</span><span class="p">,</span>   <span class="c1"># Iterate Fermi level</span>
    <span class="s1">&#39;ltcte&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ltete&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ltriplet&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lfxceps&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lfxheg&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;l2order&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lmp2lt&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lgwlf&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lusew&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;selfenergy&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;oddonlygw&#39;</span><span class="p">,</span>  <span class="c1"># Avoid gamma point in response function calc.</span>
    <span class="s1">&#39;evenonlygw&#39;</span><span class="p">,</span>  <span class="c1"># Avoid even points in response function calc.</span>
    <span class="s1">&#39;lspectralgw&#39;</span><span class="p">,</span>  <span class="c1"># More accurate self-energy calculation</span>
    <span class="s1">&#39;fletcher_reeves&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented dimer parameter</span>
    <span class="s1">&#39;lidm_selective&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented dimer parameter</span>
    <span class="s1">&#39;lblueout&#39;</span><span class="p">,</span>   <span class="c1"># Write output of blue-moon algorithm</span>
    <span class="s1">&#39;hills_variable_w&#39;</span><span class="p">,</span>  <span class="c1"># Enable variable-width metadynamics bias</span>
    <span class="s1">&#39;dvvminus&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lpead&#39;</span><span class="p">,</span>      <span class="c1"># Calculate cell-periodic orbital derivs. using finite diff.</span>
    <span class="s1">&#39;skip_edotp&#39;</span><span class="p">,</span>  <span class="c1"># Skip updating elec. polarization during scf</span>
    <span class="s1">&#39;skip_scf&#39;</span><span class="p">,</span>   <span class="c1"># Skip calculation w/ local field effects</span>
    <span class="s1">&#39;lchgfit&#39;</span><span class="p">,</span>    <span class="c1"># Turn on charge fitting</span>
    <span class="s1">&#39;lgausrc&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented charge fitting parameter</span>
    <span class="s1">&#39;lstockholder&#39;</span><span class="p">,</span>  <span class="c1"># Enable ISA charge fitting (?)</span>
    <span class="s1">&#39;lsymgrad&#39;</span><span class="p">,</span>   <span class="c1"># Restore symmetry of gradient (HF)</span>
    <span class="s1">&#39;lhfone&#39;</span><span class="p">,</span>     <span class="c1"># Calculate one-center terms (HF)</span>
    <span class="s1">&#39;lrscor&#39;</span><span class="p">,</span>     <span class="c1"># Include long-range correlation (HF)</span>
    <span class="s1">&#39;lrhfcalc&#39;</span><span class="p">,</span>   <span class="c1"># Include long-range HF (HF)</span>
    <span class="s1">&#39;lmodelhf&#39;</span><span class="p">,</span>   <span class="c1"># Model HF calculation (HF)</span>
    <span class="s1">&#39;shiftred&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented HF paramter</span>
    <span class="s1">&#39;hfkident&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;oddonly&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;evenonly&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;lfockaedft&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;lsubsrot&#39;</span><span class="p">,</span>   <span class="c1"># Enable subspace rotation diagonalization</span>
    <span class="s1">&#39;mixfirst&#39;</span><span class="p">,</span>   <span class="c1"># Mix before diagonalization</span>
    <span class="s1">&#39;lvcader&#39;</span><span class="p">,</span>    <span class="c1"># Calculate derivs. w.r.t. VCA parameters</span>
    <span class="s1">&#39;lcompat&#39;</span><span class="p">,</span>    <span class="c1"># Enable &quot;full compatibility&quot;</span>
    <span class="s1">&#39;lmusic&#39;</span><span class="p">,</span>     <span class="c1"># &quot;Joke&quot; parameter</span>
    <span class="s1">&#39;ldownsample&#39;</span><span class="p">,</span>  <span class="c1"># Downsample WAVECAR to fewer k-points</span>
    <span class="s1">&#39;lscaaware&#39;</span><span class="p">,</span>  <span class="c1"># Disable ScaLAPACK for some things but not all</span>
    <span class="s1">&#39;lorbitalreal&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lmetagga&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lspiral&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lzeroz&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lmono&#39;</span><span class="p">,</span>      <span class="c1"># Enable &quot;monopole&quot; corrections</span>
    <span class="s1">&#39;lrelcore&#39;</span><span class="p">,</span>   <span class="c1"># Perform relaxed core calculation</span>
    <span class="s1">&#39;lmimicfc&#39;</span><span class="p">,</span>   <span class="c1"># Mimic frozen-core calcs. for relaxed core calcs.</span>
    <span class="s1">&#39;lmatchrw&#39;</span><span class="p">,</span>   <span class="c1"># Match PS partial waves at RWIGS? (otherwise PAW cutoff)</span>
    <span class="s1">&#39;ladaptelin&#39;</span><span class="p">,</span>  <span class="c1"># Linearize core state energies to avoid divergences</span>
    <span class="s1">&#39;lonlysemicore&#39;</span><span class="p">,</span>  <span class="c1"># Only linearize semi-core state energies</span>
    <span class="s1">&#39;gga_compat&#39;</span><span class="p">,</span>  <span class="c1"># Enable backwards-compatible symmetrization of GGA derivs.</span>
    <span class="s1">&#39;lrelvol&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lj_only&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lvdwscs&#39;</span><span class="p">,</span>    <span class="c1"># Include self-consistent screening in TS vdW correction</span>
    <span class="s1">&#39;lcfdm&#39;</span><span class="p">,</span>      <span class="c1"># Use coupled fluctuating dipoles model for TS vdW</span>
    <span class="s1">&#39;lvdw_sametype&#39;</span><span class="p">,</span>  <span class="c1"># Include interactions between atoms of the same type</span>
    <span class="s1">&#39;lrescaler0&#39;</span><span class="p">,</span>  <span class="c1"># Rescale damping parameters in SCS vdW correction</span>
    <span class="s1">&#39;lscsgrad&#39;</span><span class="p">,</span>   <span class="c1"># Calculate gradients for TS+SCS vdW correction energies</span>
    <span class="s1">&#39;lvdwexpansion&#39;</span><span class="p">,</span>  <span class="c1"># Write 2-6 body contribs. to MBD vdW correction energy</span>
    <span class="s1">&#39;lvdw_relvolone&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lberry&#39;</span><span class="p">,</span>     <span class="c1"># Enable Berry-phase calculation</span>
    <span class="s1">&#39;lpade_fit&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented QP parameter</span>
    <span class="s1">&#39;lkproj&#39;</span><span class="p">,</span>     <span class="c1"># Enable projection onto k-points</span>
    <span class="s1">&#39;l_wr_moments&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;l_wr_density&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lkotani&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;ldyson&#39;</span><span class="p">,</span>     <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;laddherm&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lcrpaplot&#39;</span><span class="p">,</span>  <span class="c1"># Plot bands used in CRPA response func. calc.</span>
    <span class="s1">&#39;lplotdis&#39;</span><span class="p">,</span>   <span class="c1"># Plot disentangled bands in CRPA response func. calc.</span>
    <span class="s1">&#39;ldisentangle&#39;</span><span class="p">,</span>  <span class="c1"># Disentangle bands in CRPA</span>
    <span class="s1">&#39;lweighted&#39;</span><span class="p">,</span>  <span class="c1"># &quot;Weighted&quot; CRPA approach</span>
    <span class="s1">&#39;luseorth_lcaos&#39;</span><span class="p">,</span>  <span class="c1"># Use orthogonalized LCAOs in CRPA</span>
    <span class="s1">&#39;lfrpa&#39;</span><span class="p">,</span>      <span class="c1"># Use full RPA in CRPA</span>
    <span class="s1">&#39;lregularize&#39;</span><span class="p">,</span>  <span class="c1"># Regularize projectors in CRPA</span>
    <span class="s1">&#39;ldrude&#39;</span><span class="p">,</span>     <span class="c1"># Include Drude term in CRPA</span>
    <span class="s1">&#39;ldmatrix&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;lefg&#39;</span><span class="p">,</span>       <span class="c1"># Calculate electric field gradient at atomic nuclei</span>
    <span class="s1">&#39;lhyperfine&#39;</span><span class="p">,</span>  <span class="c1"># Enable Hyperfine calculation</span>
    <span class="s1">&#39;lwannier&#39;</span><span class="p">,</span>   <span class="c1"># Enable Wannier interface</span>
    <span class="s1">&#39;localize&#39;</span><span class="p">,</span>   <span class="c1"># Undocumented Wannier parameter</span>
    <span class="s1">&#39;lintpol_wpot&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate WPOT for Wannier</span>
    <span class="s1">&#39;lintpol_orb&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate orbitals for Wannier</span>
    <span class="s1">&#39;lintpol_kpath&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate bandstructure on given kpath for Wannier</span>
    <span class="s1">&#39;lintpol_kpath_orb&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate orbitals on given kpath for Wannier</span>
    <span class="s1">&#39;lread_eigenvalues&#39;</span><span class="p">,</span>  <span class="c1"># Use Eigenvalues from EIGENVALUES.INT file</span>
    <span class="s1">&#39;lintpol_velocity&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate electron velocity for Wannier</span>
    <span class="s1">&#39;lintpol_conductivity&#39;</span><span class="p">,</span>  <span class="c1"># Interpolate conductivity for Wannier</span>
    <span class="s1">&#39;lwannierinterpol&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented Wannier parameter</span>
    <span class="s1">&#39;wanproj&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented Wannier parameter</span>
    <span class="s1">&#39;lorbmom&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented LDA+U parameter</span>
    <span class="s1">&#39;lwannier90_run&#39;</span><span class="p">,</span>  <span class="c1"># Undocumented WANNIER90 parameter</span>
    <span class="s1">&#39;lwrite_wanproj&#39;</span><span class="p">,</span>  <span class="c1"># Write UWAN files for WANNIER90</span>
    <span class="s1">&#39;lwrite_unk&#39;</span><span class="p">,</span>  <span class="c1"># Write UNK files for WANNIER90</span>
    <span class="s1">&#39;lwrite_mmn_amn&#39;</span><span class="p">,</span>  <span class="c1"># Write MMN and AMN files for WANNIER90</span>
    <span class="s1">&#39;lread_amn&#39;</span><span class="p">,</span>  <span class="c1"># Read AMN files instead of recomputing (WANNIER90)</span>
    <span class="s1">&#39;lrhfatm&#39;</span><span class="p">,</span>    <span class="c1"># Undocumented HF parameter</span>
    <span class="s1">&#39;lvpot&#39;</span><span class="p">,</span>      <span class="c1"># Calculate unscreened potential</span>
    <span class="s1">&#39;lwpot&#39;</span><span class="p">,</span>      <span class="c1"># Calculate screened potential</span>
    <span class="s1">&#39;lwswq&#39;</span><span class="p">,</span>      <span class="c1"># Undocumented parameter</span>
    <span class="s1">&#39;pflat&#39;</span><span class="p">,</span>      <span class="c1"># Only print &quot;flat&quot; timings to OUTCAR</span>
    <span class="s1">&#39;qifcg&#39;</span><span class="p">,</span>      <span class="c1"># Use CG instead of quickmin (instanton)</span>
    <span class="s1">&#39;qdo_ins&#39;</span><span class="p">,</span>    <span class="c1"># Find instanton</span>
    <span class="s1">&#39;qdo_pre&#39;</span><span class="p">,</span>    <span class="c1"># Calculate prefactor (instanton)</span>
<span class="p">]</span>

<span class="n">list_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;dipol&#39;</span><span class="p">,</span>      <span class="c1"># center of cell for dipol</span>
    <span class="s1">&#39;eint&#39;</span><span class="p">,</span>       <span class="c1"># energy range to calculate partial charge for</span>
    <span class="s1">&#39;ferwe&#39;</span><span class="p">,</span>      <span class="c1"># Fixed band occupation (spin-paired)</span>
    <span class="s1">&#39;ferdo&#39;</span><span class="p">,</span>      <span class="c1"># Fixed band occupation (spin-plarized)</span>
    <span class="s1">&#39;iband&#39;</span><span class="p">,</span>      <span class="c1"># bands to calculate partial charge for</span>
    <span class="s1">&#39;magmom&#39;</span><span class="p">,</span>     <span class="c1"># initial magnetic moments</span>
    <span class="s1">&#39;kpuse&#39;</span><span class="p">,</span>      <span class="c1"># k-point to calculate partial charge for</span>
    <span class="s1">&#39;ropt&#39;</span><span class="p">,</span>       <span class="c1"># number of grid points for non-local proj in real space</span>
    <span class="s1">&#39;rwigs&#39;</span><span class="p">,</span>      <span class="c1"># Wigner-Seitz radii</span>
    <span class="s1">&#39;ldauu&#39;</span><span class="p">,</span>      <span class="c1"># ldau parameters, has potential to redundant w.r.t. dict</span>
    <span class="s1">&#39;ldaul&#39;</span><span class="p">,</span>      <span class="c1"># key &#39;ldau_luj&#39;, but &#39;ldau_luj&#39; can&#39;t be read direct from</span>
    <span class="s1">&#39;ldauj&#39;</span><span class="p">,</span>      <span class="c1"># the INCAR (since it needs to know information about atomic</span>
                  <span class="c1"># species. In case of conflict &#39;ldau_luj&#39; gets written out</span>
                  <span class="c1"># when a calculation is set up</span>

    <span class="s1">&#39;random_seed&#39;</span><span class="p">,</span>  <span class="c1"># List of ints used to seed RNG for advanced MD routines</span>
                    <span class="c1"># (Bucko)</span>
    <span class="s1">&#39;vdw_c6&#39;</span><span class="p">,</span>     <span class="c1"># List of floats of C6 parameters (J nm^6 mol^-1) for each</span>
                  <span class="c1"># species (DFT-D2 and DFT-TS)</span>
    <span class="s1">&#39;vdw_c6au&#39;</span><span class="p">,</span>   <span class="c1"># List of floats of C6 parameters (a.u.) for each species</span>
                  <span class="c1"># (DFT-TS)</span>
    <span class="s1">&#39;vdw_r0&#39;</span><span class="p">,</span>     <span class="c1"># List of floats of R0 parameters (angstroms) for each</span>
                  <span class="c1"># species (DFT-D2 and DFT-TS)</span>
    <span class="s1">&#39;vdw_r0au&#39;</span><span class="p">,</span>   <span class="c1"># List of floats of R0 parameters (a.u.) for each species</span>
                  <span class="c1"># (DFT-TS)</span>
    <span class="s1">&#39;vdw_alpha&#39;</span><span class="p">,</span>  <span class="c1"># List of floats of free-atomic polarizabilities for each</span>
                  <span class="c1"># species (DFT-TS)</span>
    <span class="s1">&#39;langevin_gamma&#39;</span><span class="p">,</span>  <span class="c1"># List of floats for langevin friction coefficients</span>
    <span class="s1">&#39;auger_bmin_eeh&#39;</span><span class="p">,</span>  <span class="c1"># 4 ints | Various undocumented parameters for Auger</span>
    <span class="s1">&#39;auger_bmax_eeh&#39;</span><span class="p">,</span>  <span class="c1"># 4 ints | calculations start here...</span>
    <span class="s1">&#39;auger_bmin_ehh&#39;</span><span class="p">,</span>  <span class="c1"># 4 ints</span>
    <span class="s1">&#39;auger_bmax_ehh&#39;</span><span class="p">,</span>  <span class="c1"># 4 ints</span>
    <span class="s1">&#39;auger_emin_eeh&#39;</span><span class="p">,</span>  <span class="c1"># 4 floats</span>
    <span class="s1">&#39;auger_emax_eeh&#39;</span><span class="p">,</span>  <span class="c1"># 4 floats</span>
    <span class="s1">&#39;auger_emin_ehh&#39;</span><span class="p">,</span>  <span class="c1"># 4 floats</span>
    <span class="s1">&#39;auger_emax_ehh&#39;</span><span class="p">,</span>  <span class="c1"># 4 floats | End of Auger parameters</span>
    <span class="s1">&#39;avecconst&#39;</span><span class="p">,</span>  <span class="c1"># 3 floats | magnitude of magnetic moment (NMR)</span>
    <span class="s1">&#39;magdipol&#39;</span><span class="p">,</span>   <span class="c1"># 3 floats | magnitude of magnetic dipole (NMR)</span>
    <span class="s1">&#39;bconst&#39;</span><span class="p">,</span>     <span class="c1"># 3 floats | magnitude of constant magnetic field (NMR)</span>
    <span class="s1">&#39;magpos&#39;</span><span class="p">,</span>     <span class="c1"># 3 floats | position for magnetic moment w/ &#39;nucind&#39; (NMR)</span>
    <span class="s1">&#39;balist&#39;</span><span class="p">,</span>     <span class="c1"># nbas ints | Undocumented Bond-Boost parameter (GH patches)</span>
    <span class="s1">&#39;bext&#39;</span><span class="p">,</span>       <span class="c1"># 3 floats | Undocumented (probably external magnetic field)</span>
    <span class="s1">&#39;core_c&#39;</span><span class="p">,</span>     <span class="c1"># ntyp floats | pseudo-core charge magnitude (VASPsol)</span>
    <span class="s1">&#39;sigma_rc_k&#39;</span><span class="p">,</span>  <span class="c1"># ntyp floats | width of pseudo-core gaussians (VASPsol)</span>
    <span class="s1">&#39;darwinr&#39;</span><span class="p">,</span>    <span class="c1"># ntypd (?) floats | Undocumented parameter</span>
    <span class="s1">&#39;darwinv&#39;</span><span class="p">,</span>    <span class="c1"># ntypd (?) floats | Undocumented parameter</span>
    <span class="s1">&#39;kpoint_bse&#39;</span><span class="p">,</span>  <span class="c1"># 4 ints | Undocumented parameter</span>
    <span class="s1">&#39;dummy_k&#39;</span><span class="p">,</span>    <span class="c1"># ? floats | Force const. connecting dummy atoms to sys.</span>
    <span class="s1">&#39;dummy_r0&#39;</span><span class="p">,</span>   <span class="c1"># ? floats | Minimum dist., ang., etc. for dummy atom DOFs</span>
    <span class="s1">&#39;dummy_positions&#39;</span><span class="p">,</span>  <span class="c1"># 3 floats | Position of dummy atom(s?)</span>
    <span class="s1">&#39;nsubsys&#39;</span><span class="p">,</span>    <span class="c1"># &lt;=3 ints | Last atom # for each of up to 3 thermostats</span>
    <span class="s1">&#39;psubsys&#39;</span><span class="p">,</span>    <span class="c1"># &lt;=3 floats | Coll. prob. for each of up to 3 thermostats</span>
    <span class="s1">&#39;tsubsys&#39;</span><span class="p">,</span>    <span class="c1"># &lt;=3 floats | Temp. for each of up to 3 thermostats</span>
    <span class="s1">&#39;increm&#39;</span><span class="p">,</span>     <span class="c1"># ? floats | Undocumented advanced MD parameter</span>
    <span class="s1">&#39;value_min&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Undocumented advanced MD parameter</span>
    <span class="s1">&#39;value_max&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Undocumented advanced MD parameter</span>
    <span class="s1">&#39;lattice_constraints&#39;</span><span class="p">,</span>  <span class="c1"># 3 bools | Undocumented advanced MD parameter</span>
    <span class="s1">&#39;hills_position&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Dummy particle(s) pos. for metadynamics</span>
    <span class="s1">&#39;hills_velocity&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Dummy particle(s) vel. for metadynamics</span>
    <span class="s1">&#39;spring_k&#39;</span><span class="p">,</span>   <span class="c1"># ? floats | Spring constant for harmonic constraints</span>
    <span class="s1">&#39;spring_r0&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Spring minima for harmonic constraints</span>
    <span class="s1">&#39;spring_v0&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Initial velocity of harmonic constraints</span>
    <span class="s1">&#39;hills_wall_lower&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Undocumented metadynamics parameter</span>
    <span class="s1">&#39;hills_wall_upper&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | Undocumented metadynamics parameter</span>
    <span class="s1">&#39;efield_pead&#39;</span><span class="p">,</span>  <span class="c1"># 3 floats | homogeneous electric field for PEAD calc.</span>
    <span class="s1">&#39;zct&#39;</span><span class="p">,</span>        <span class="c1"># ? floats | Undocumented charge fitting parameter</span>
    <span class="s1">&#39;rgaus&#39;</span><span class="p">,</span>      <span class="c1"># ? floats | Undocumented charge fitting parameter</span>
    <span class="s1">&#39;hfalpha&#39;</span><span class="p">,</span>    <span class="c1"># 10 floats | Undocumented HF parameter</span>
    <span class="s1">&#39;mcalpha&#39;</span><span class="p">,</span>    <span class="c1"># 10 floats | Undocumented HF parameter</span>
    <span class="s1">&#39;saxis&#39;</span><span class="p">,</span>      <span class="c1"># 3 floats | Coordinate for collinear spin calculations</span>
    <span class="s1">&#39;vca&#39;</span><span class="p">,</span>        <span class="c1"># ? floats | Atom weight for VCA calculations</span>
    <span class="s1">&#39;stm&#39;</span><span class="p">,</span>        <span class="c1"># 7 floats | &quot;range for STM data&quot;</span>
    <span class="s1">&#39;qspiral&#39;</span><span class="p">,</span>    <span class="c1"># 3 floats | Undocumented parameter</span>
    <span class="s1">&#39;lrctype&#39;</span><span class="p">,</span>    <span class="c1"># ntyp bools | Enable relaxed-core calc. for these atoms</span>
    <span class="s1">&#39;external_stress&#39;</span><span class="p">,</span>  <span class="c1"># 6 floats | Target stress (adds w/ external_pressure)</span>
    <span class="s1">&#39;vdw_refstate&#39;</span><span class="p">,</span>  <span class="c1"># ntyp ints | Undocumented classical vdW parameter</span>
    <span class="s1">&#39;lvdw_onecell&#39;</span><span class="p">,</span>  <span class="c1"># 3 bools | Enable periodicity in A, B, C vector for vdW</span>
    <span class="s1">&#39;vdw_mbd_size&#39;</span><span class="p">,</span>  <span class="c1"># 3 ints | Supercell size for TS MBD vdW correction</span>
    <span class="s1">&#39;m_constr&#39;</span><span class="p">,</span>   <span class="c1"># 3*nions floats | Local magmom assigned to each spin DOF</span>
    <span class="s1">&#39;nbands_index&#39;</span><span class="p">,</span>  <span class="c1"># nbands_out ints | Undocumented QP parameter</span>
    <span class="s1">&#39;kpts_index&#39;</span><span class="p">,</span>  <span class="c1"># kpts_out ints | Undocumented QP parameter</span>
    <span class="s1">&#39;isp_index&#39;</span><span class="p">,</span>  <span class="c1"># isp_out ints | Undocumented QP parameter</span>
    <span class="s1">&#39;nomega_index&#39;</span><span class="p">,</span>  <span class="c1"># nomega_out ints | Undocumented QP parameter</span>
    <span class="s1">&#39;ntarget_states&#39;</span><span class="p">,</span>  <span class="c1"># nbands ints | Undocumented CRPA parameter</span>
    <span class="s1">&#39;quad_efg&#39;</span><span class="p">,</span>   <span class="c1"># ntyp floats | Nuclear quadrupole moments</span>
    <span class="s1">&#39;ngyromag&#39;</span><span class="p">,</span>   <span class="c1"># ntyp floats | Nuclear gyromagnetic ratios</span>
    <span class="s1">&#39;rcrhocut&#39;</span><span class="p">,</span>   <span class="c1"># ntyp floats | Core density cutoff rad. for HF relcore calc</span>
    <span class="s1">&#39;ofield_k&#39;</span><span class="p">,</span>   <span class="c1"># 3 floats | Undocumented parameter</span>
    <span class="s1">&#39;paripot&#39;</span><span class="p">,</span>    <span class="c1"># ? floats | Undocumented parameter</span>
    <span class="s1">&#39;smearings&#39;</span><span class="p">,</span>  <span class="c1"># ? floats | ismear,sigma smearing params to loop over</span>
    <span class="s1">&#39;wanproj_i&#39;</span><span class="p">,</span>  <span class="c1"># nions ints | Undocumented Wannier parameter</span>
    <span class="s1">&#39;wanproj_l&#39;</span><span class="p">,</span>  <span class="c1"># ? ints | Undocumented Wannier parameter</span>
    <span class="s1">&#39;wanproj_e&#39;</span><span class="p">,</span>  <span class="c1"># 2 floats | Undocumented Wannier parameter</span>
<span class="p">]</span>

<span class="n">special_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;lreal&#39;</span><span class="p">,</span>      <span class="c1"># non-local projectors in real space</span>
<span class="p">]</span>

<span class="n">dict_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ldau_luj&#39;</span><span class="p">,</span>   <span class="c1"># dictionary with L(S)DA+U parameters, e.g. {&#39;Fe&#39;:{&#39;L&#39;:2,</span>
                  <span class="c1"># &#39;U&#39;:4.0, &#39;J&#39;:0.9}, ...}</span>
<span class="p">]</span>

<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># &#39;NBLOCK&#39; and KBLOCK       inner block; outer block</span>
    <span class="c1"># &#39;NPACO&#39; and APACO         distance and nr. of slots for P.C.</span>
    <span class="c1"># &#39;WEIMIN, EBREAK, DEPER    special control tags</span>
<span class="p">]</span>


<div class="viewcode-block" id="GenerateVaspInput"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput">[docs]</a><span class="k">class</span> <span class="nc">GenerateVaspInput</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># Parameters corresponding to &#39;xc&#39; settings.  This may be modified</span>
    <span class="c1"># by the user in-between loading calculators.vasp submodule and</span>
    <span class="c1"># instantiating the calculator object with calculators.vasp.Vasp()</span>
    <span class="n">xc_defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;lda&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;LDA&#39;</span><span class="p">},</span>
        <span class="c1"># GGAs</span>
<span class="c1"># ishi  &#39;pw91&#39;: {&#39;pp&#39;: &#39;GGA&#39;, &#39;gga&#39;: &#39;91&#39;},</span>
        <span class="s1">&#39;pw91&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;pw91&#39;</span><span class="p">,</span> <span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;91&#39;</span><span class="p">},</span>
        <span class="s1">&#39;pbe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;PBE&#39;</span><span class="p">,</span> <span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">},</span>
        <span class="s1">&#39;pbesol&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">},</span>
        <span class="s1">&#39;revpbe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;RE&#39;</span><span class="p">},</span>
        <span class="s1">&#39;rpbe&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;RP&#39;</span><span class="p">},</span>
        <span class="s1">&#39;am05&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;AM&#39;</span><span class="p">},</span>
        <span class="c1"># Meta-GGAs</span>
        <span class="s1">&#39;tpss&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;TPSS&#39;</span><span class="p">},</span>
        <span class="s1">&#39;revtpss&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;RTPSS&#39;</span><span class="p">},</span>
        <span class="s1">&#39;m06l&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;M06L&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ms0&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;MS0&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ms1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;MS1&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ms2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;MS2&#39;</span><span class="p">},</span>
        <span class="s1">&#39;scan&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;SCAN&#39;</span><span class="p">},</span>
        <span class="s1">&#39;scan-rvv10&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;metagga&#39;</span><span class="p">:</span> <span class="s1">&#39;SCAN&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;bparam&#39;</span><span class="p">:</span> <span class="mf">15.7</span><span class="p">},</span>
        <span class="c1"># vdW-DFs</span>
        <span class="s1">&#39;vdw-df&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;RE&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">},</span>
        <span class="s1">&#39;optpbe-vdw&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;OR&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
        <span class="s1">&#39;optb88-vdw&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;BO&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                       <span class="s1">&#39;param1&#39;</span><span class="p">:</span> <span class="mf">1.1</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">,</span> <span class="s1">&#39;param2&#39;</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">},</span>
        <span class="s1">&#39;optb86b-vdw&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;MK&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="s1">&#39;param1&#39;</span><span class="p">:</span> <span class="mf">0.1234</span><span class="p">,</span> <span class="s1">&#39;param2&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
        <span class="s1">&#39;vdw-df2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="s1">&#39;zab_vdw&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8867</span><span class="p">},</span>
        <span class="s1">&#39;beef-vdw&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;BF&#39;</span><span class="p">,</span> <span class="s1">&#39;luse_vdw&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                     <span class="s1">&#39;zab_vdw&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8867</span><span class="p">},</span>
        <span class="c1"># Hartree-Fock and hybrids</span>
        <span class="s1">&#39;hf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aexx&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;aldac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
               <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
        <span class="s1">&#39;b3lyp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;aexx&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                  <span class="s1">&#39;aggax&#39;</span><span class="p">:</span> <span class="mf">0.72</span><span class="p">,</span> <span class="s1">&#39;aggac&#39;</span><span class="p">:</span> <span class="mf">0.81</span><span class="p">,</span> <span class="s1">&#39;aldac&#39;</span><span class="p">:</span> <span class="mf">0.19</span><span class="p">},</span>
        <span class="s1">&#39;pbe0&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="s1">&#39;hse03&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hfscreen&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>
        <span class="s1">&#39;hse06&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hfscreen&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span>
        <span class="s1">&#39;hsesol&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;gga&#39;</span><span class="p">:</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span> <span class="s1">&#39;lhfcalc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;hfscreen&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">}}</span>

    <span class="c1"># elements which have no-suffix files only</span>
    <span class="n">setups_defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;K&#39;</span><span class="p">:</span>  <span class="s1">&#39;_pv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Ca&#39;</span><span class="p">:</span> <span class="s1">&#39;_pv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Rb&#39;</span><span class="p">:</span> <span class="s1">&#39;_pv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Sr&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Y&#39;</span><span class="p">:</span>  <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Zr&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Nb&#39;</span><span class="p">:</span> <span class="s1">&#39;_pv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Cs&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Ba&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Fr&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Ra&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Sc&#39;</span><span class="p">:</span> <span class="s1">&#39;_sv&#39;</span><span class="p">}</span>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restart</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">float_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">exp_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">string_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">int_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bool_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">list_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">special_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Initialize internal dictionary of input parameters which are</span>
        <span class="c1"># not regular VASP keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Exchange-correlation recipe (e.g. &#39;B3LYP&#39;)</span>
            <span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Pseudopotential file (e.g. &#39;PW91&#39;)</span>
            <span class="s1">&#39;setups&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Special setups (e.g pv, sv, ...)</span>
            <span class="s1">&#39;txt&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>  <span class="c1"># Where to send information</span>
            <span class="s1">&#39;kpts&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># k-points</span>
            <span class="c1"># Option to use gamma-sampling instead of Monkhorst-Pack:</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="c1"># number of points between points in band structures:</span>
            <span class="s1">&#39;kpts_nintersections&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="c1"># Option to write explicit k-points in units</span>
            <span class="c1"># of reciprocal lattice vectors:</span>
            <span class="s1">&#39;reciprocal&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<div class="viewcode-block" id="GenerateVaspInput.set_xc_params"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.set_xc_params">[docs]</a>    <span class="k">def</span> <span class="nf">set_xc_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set parameters corresponding to XC functional&quot;&quot;&quot;</span>
        <span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">xc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc_defaults</span><span class="p">:</span>
            <span class="n">xc_allowed</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xc_defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> is not supported for xc! Supported xc values&#39;</span>
                <span class="s1">&#39;are: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">xc_allowed</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># XC defaults to PBE pseudopotentials</span>
            <span class="k">if</span> <span class="s1">&#39;pp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc_defaults</span><span class="p">[</span><span class="n">xc</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="s1">&#39;PBE&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">xc_defaults</span><span class="p">[</span><span class="n">xc</span><span class="p">])</span></div>

<div class="viewcode-block" id="GenerateVaspInput.set"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="p">(((</span><span class="s1">&#39;ldauu&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span>
             <span class="p">(</span><span class="s1">&#39;ldaul&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span>
             <span class="p">(</span><span class="s1">&#39;ldauj&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span>
             <span class="p">(</span><span class="s1">&#39;ldau_luj&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s1">&#39;You can either specify ldaul, ldauu, and ldauj OR &#39;</span>
                <span class="s1">&#39;ldau_luj. ldau_luj is not a VASP keyword. It is a &#39;</span>
                <span class="s1">&#39;dictionary that specifies L, U and J for each &#39;</span>
                <span class="s1">&#39;chemical species in the atoms object. &#39;</span>
                <span class="s1">&#39;For example for a water molecule:&#39;</span>
                <span class="sd">&#39;&#39;&#39;ldau_luj={&#39;H&#39;:{&#39;L&#39;:2, &#39;U&#39;:4.0, &#39;J&#39;:0.9},</span>
<span class="sd">                      &#39;O&#39;:{&#39;L&#39;:2, &#39;U&#39;:4.0, &#39;J&#39;:0.9}}&#39;&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;xc&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_xc_params</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Parameter not defined: &#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateVaspInput.check_xc"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.check_xc">[docs]</a>    <span class="k">def</span> <span class="nf">check_xc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make sure the calculator has functional &amp; pseudopotentials set up</span>

<span class="sd">        If no XC combination, GGA functional or POTCAR type is specified,</span>
<span class="sd">        default to PW91. Otherwise, try to guess the desired pseudopotentials.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span>
        <span class="c1">#p.update({&#39;pp&#39;: &#39;pw91&#39;})</span>

        <span class="c1"># There is no way to correctly guess the desired</span>
        <span class="c1"># set of pseudopotentials without &#39;pp&#39; being set.</span>
        <span class="c1"># Usually, &#39;pp&#39; will be set by &#39;xc&#39;.</span>
        <span class="k">if</span> <span class="s1">&#39;pp&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">p</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="s1">&#39;gga&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;lda&#39;</span><span class="p">})</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="s1">&#39;gga&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;91&#39;</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;pw91&#39;</span><span class="p">})</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="s1">&#39;gga&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PE&#39;</span><span class="p">:</span>
                <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;pp&#39;</span><span class="p">:</span> <span class="s1">&#39;pbe&#39;</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="s2">&quot;Unable to guess the desired set of pseudopotential&quot;</span>
                    <span class="s2">&quot;(POTCAR) files. Please do one of the following: </span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;1. Use the &#39;xc&#39; parameter to define your XC functional.&quot;</span>
                    <span class="s2">&quot;These &#39;recipes&#39; determine the pseudopotential file as &quot;</span>
                    <span class="s2">&quot;well as setting the INCAR parameters.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;2. Use the &#39;gga&#39; settings None (default), &#39;PE&#39; or &#39;91&#39;; &quot;</span>
                    <span class="s2">&quot;these correspond to LDA, PBE and PW91 respectively.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;3. Set the POTCAR explicitly with the &#39;pp&#39; flag. The &quot;</span>
                    <span class="s2">&quot;value should be the name of a folder on the VASP_PP_PATH&quot;</span>
                    <span class="s2">&quot;, and the aliases &#39;LDA&#39;, &#39;PBE&#39; and &#39;PW91&#39; are also&quot;</span>
                    <span class="s2">&quot;accepted.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;lda&#39;</span> <span class="ow">and</span>
                <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;lda&#39;</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;XC is set to LDA, but PP is set to &quot;</span>
                          <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">. </span><span class="se">\n</span><span class="s2">This calculation is using the </span><span class="si">{0}</span><span class="s2"> &quot;</span>
                          <span class="s2">&quot;POTCAR set. </span><span class="se">\n</span><span class="s2"> Please check that this is &quot;</span>
                          <span class="s2">&quot;really what you intended!&quot;</span>
                          <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span></div>

<div class="viewcode-block" id="GenerateVaspInput.initialize"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a VASP calculation</span>

<span class="sd">        Constructs the POTCAR file (does not actually write it).</span>
<span class="sd">        User should specify the PATH</span>
<span class="sd">        to the pseudopotentials in VASP_PP_PATH environment variable</span>

<span class="sd">        The pseudopotentials are expected to be in:</span>
<span class="sd">        LDA:  $VASP_PP_PATH/potpaw/</span>
<span class="sd">        PBE:  $VASP_PP_PATH/potpaw_PBE/</span>
<span class="sd">        PW91: $VASP_PP_PATH/potpaw_GGA/</span>

<span class="sd">        if your pseudopotentials are somewhere else, or named</span>
<span class="sd">        differently you may make symlinks at the paths above that</span>
<span class="sd">        point to the right place. Alternatively, you may pass the full</span>
<span class="sd">        name of a folder on the VASP_PP_PATH to the &#39;pp&#39; parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_xc</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_symbols</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spinpol</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_initial_magnetic_moments</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="n">atomtypes</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>

        <span class="c1"># Determine the number of atoms of each atomic species</span>
        <span class="c1"># sorted after atomic species</span>
        <span class="n">special_setups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">symbolcount</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># make sure we find POTCARs for elements which have no-suffix files only</span>
        <span class="n">setups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setups_defaults</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># override with user defined setups</span>
        <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;setups&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">setups</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;setups&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">setups</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">special_setups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="n">symbol</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">symbol</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">special_setups</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">symbol</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
                    <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                    <span class="n">symbolcount</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">symbolcount</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Build the sorting list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">special_setups</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">special_setups</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="n">symbol</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resort</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resort</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resort</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms_sorted</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">]</span>

        <span class="c1"># Check if the necessary POTCAR files exists and</span>
        <span class="c1"># create a list of their paths.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol_count</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">special_setups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symbol_count</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atomtypes</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symbol_count</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">symbolcount</span><span class="p">[</span><span class="n">m</span><span class="p">]])</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="c1"># Potpaw folders may be identified by an alias or full name</span>
        <span class="k">for</span> <span class="n">pp_alias</span><span class="p">,</span> <span class="n">pp_folder</span> <span class="ow">in</span> <span class="p">((</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="s1">&#39;potpaw&#39;</span><span class="p">),</span>
                                    <span class="p">(</span><span class="s1">&#39;pw91&#39;</span><span class="p">,</span> <span class="s1">&#39;potpaw_GGA&#39;</span><span class="p">),</span>
                                    <span class="p">(</span><span class="s1">&#39;pbe&#39;</span><span class="p">,</span> <span class="s1">&#39;potpaw_PBE&#39;</span><span class="p">)):</span>
<span class="c1">#                                   (&#39;pbe&#39;, &#39;potpaw_PBE.54&#39;)):</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">pp_alias</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pp_folder</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;VASP_PP_PATH&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
            <span class="n">pppaths</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;VASP_PP_PATH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pppaths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Setting the pseudopotentials, first special setups and</span>
        <span class="c1"># then according to symbols</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">special_setups</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">setups</span><span class="p">:</span>
                <span class="n">special_setup_index</span> <span class="o">=</span> <span class="n">m</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="n">setups</span><span class="p">:</span>
                <span class="n">special_setup_index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Having trouble with special setup index </span><span class="si">{0}</span><span class="s2">.&quot;</span>
                                <span class="s2">&quot; Please use an int.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
            <span class="n">potcar</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">pp_folder</span><span class="p">,</span>
                          <span class="n">setups</span><span class="p">[</span><span class="n">special_setup_index</span><span class="p">],</span>
                          <span class="s1">&#39;POTCAR&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">pppaths</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">potcar</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">or</span> <span class="n">islink</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">isfile</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">islink</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Looking for </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">potcar</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No pseudopotential for </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="n">symbol</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">potcar</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">pp_folder</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">+</span> <span class="n">setups</span><span class="p">[</span><span class="n">symbol</span><span class="p">],</span>
                              <span class="s1">&#39;POTCAR&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
                <span class="n">potcar</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">pp_folder</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="s1">&#39;POTCAR&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">pppaths</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">potcar</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">or</span> <span class="n">islink</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">isfile</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">islink</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.Z&#39;</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Looking for </span><span class="si">%s</span><span class="s1"></span>
<span class="s1">                The pseudopotentials are expected to be in:</span>
<span class="s1">                LDA:  $VASP_PP_PATH/potpaw/</span>
<span class="s1">                PBE:  $VASP_PP_PATH/potpaw_PBE/</span>
<span class="s1">                PW91: $VASP_PP_PATH/potpaw_GGA/&#39;&#39;&#39;</span> <span class="o">%</span> <span class="n">potcar</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No pseudopotential for </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="n">symbol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converged</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setups_changed</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="GenerateVaspInput.write_input"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.write_input">[docs]</a>    <span class="k">def</span> <span class="nf">write_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">ase.io.vasp</span> <span class="kn">import</span> <span class="n">write_vasp</span>
        <span class="n">write_vasp</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;POSCAR&#39;</span><span class="p">),</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">atoms_sorted</span><span class="p">,</span>
                   <span class="n">symbol_count</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_incar</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_potcar</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_kpoints</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_sort_file</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateVaspInput.clean"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method which cleans up after a calculation.</span>

<span class="sd">        The default files generated by Vasp will be deleted IF this</span>
<span class="sd">        method is called.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHG&#39;</span><span class="p">,</span> <span class="s1">&#39;CHGCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;POSCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;INCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CONTCAR&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DOSCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGENVAL&#39;</span><span class="p">,</span> <span class="s1">&#39;IBZKPT&#39;</span><span class="p">,</span> <span class="s1">&#39;KPOINTS&#39;</span><span class="p">,</span> <span class="s1">&#39;OSZICAR&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;OUTCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PCDAT&#39;</span><span class="p">,</span> <span class="s1">&#39;POTCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;vasprun.xml&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;WAVECAR&#39;</span><span class="p">,</span> <span class="s1">&#39;XDATCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PROCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;ase-sort.dat&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;LOCPOT&#39;</span><span class="p">,</span> <span class="s1">&#39;AECCAR0&#39;</span><span class="p">,</span> <span class="s1">&#39;AECCAR1&#39;</span><span class="p">,</span> <span class="s1">&#39;AECCAR2&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span></div>

<div class="viewcode-block" id="GenerateVaspInput.write_incar"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.write_incar">[docs]</a>    <span class="k">def</span> <span class="nf">write_incar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes the INCAR file.&quot;&quot;&quot;</span>
        <span class="c1"># jrk 1/23/2015 I added this flag because this function has</span>
        <span class="c1"># two places where magmoms get written. There is some</span>
        <span class="c1"># complication when restarting that often leads to magmom</span>
        <span class="c1"># getting written twice. this flag prevents that issue.</span>
        <span class="n">magmom_written</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">incar</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;INCAR&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;INCAR created by Atomic Simulation Environment</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%5.6f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%5.2e</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">val</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">val</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ichain&#39;</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; IBRION = 3</span><span class="se">\n</span><span class="s1"> POTIM = 0.0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;iopt&#39;</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: optimization is &#39;</span>
                                  <span class="s1">&#39;set to LFBGS (IOPT = 1)&#39;</span><span class="p">)</span>
                            <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; IOPT = 1</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ediffg&#39;</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Please set EDIFFG &lt; 0&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dipol&#39;</span><span class="p">,</span> <span class="s1">&#39;eint&#39;</span><span class="p">,</span> <span class="s1">&#39;ropt&#39;</span><span class="p">,</span> <span class="s1">&#39;rwigs&#39;</span><span class="p">,</span> <span class="s1">&#39;langevin_gamma&#39;</span><span class="p">):</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
                <span class="c1"># ldau_luj is a dictionary that encodes all the</span>
                <span class="c1"># data. It is not a vasp keyword. An alternative to</span>
                <span class="c1"># the dictionary is to to use &#39;ldauu&#39;, &#39;ldauj&#39;,</span>
                <span class="c1"># &#39;ldaul&#39;, which are vasp keywords.</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ldauu&#39;</span><span class="p">,</span> <span class="s1">&#39;ldauj&#39;</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;ldau_luj&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ldaul&#39;</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="p">[</span><span class="s1">&#39;ldau_luj&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ferwe&#39;</span><span class="p">,</span> <span class="s1">&#39;ferdo&#39;</span><span class="p">):</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;iband&#39;</span><span class="p">,</span> <span class="s1">&#39;kpuse&#39;</span><span class="p">,</span> <span class="s1">&#39;random_seed&#39;</span><span class="p">):</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;magmom&#39;</span><span class="p">:</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                    <span class="n">magmom_written</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="nb">list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="n">val</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                            <span class="nb">list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="n">n</span><span class="p">]])</span>
                    <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">*</span><span class="si">%.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                               <span class="n">mom</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                     <span class="k">for</span> <span class="n">mom</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">]</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;.TRUE.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;.FALSE.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;lreal&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
                        <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">val</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                            <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;.TRUE.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;.FALSE.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ldau_luj&#39;</span><span class="p">:</span>
                    <span class="n">llist</span> <span class="o">=</span> <span class="n">ulist</span> <span class="o">=</span> <span class="n">jlist</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol_count</span><span class="p">:</span>
                        <span class="c1">#  default: No +U</span>
                        <span class="n">luj</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
                        <span class="n">llist</span> <span class="o">+=</span> <span class="s1">&#39; </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">luj</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span>
                        <span class="n">ulist</span> <span class="o">+=</span> <span class="s1">&#39; </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">luj</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span>
                        <span class="n">jlist</span> <span class="o">+=</span> <span class="s1">&#39; </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">luj</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; LDAUL =</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">llist</span><span class="p">)</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; LDAUU =</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ulist</span><span class="p">)</span>
                    <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; LDAUJ =</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">jlist</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinpol</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">magmom_written</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">[</span><span class="s1">&#39;ispin&#39;</span><span class="p">]:</span>
                <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; ispin = 2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="c1"># Write out initial magnetic moments</span>
            <span class="n">magmom</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">get_initial_magnetic_moments</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">]</span>
            <span class="c1"># unpack magmom array if three components specified</span>
            <span class="k">if</span> <span class="n">magmom</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">magmom</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">magmom</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
            <span class="nb">list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">magmom</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">magmom</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">magmom</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="n">magmom</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                    <span class="nb">list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">magmom</span><span class="p">[</span><span class="n">n</span><span class="p">]])</span>
            <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; magmom = &#39;</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
            <span class="p">[</span><span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">*</span><span class="si">%.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mom</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">mom</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">]</span>
            <span class="n">incar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">incar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenerateVaspInput.write_kpoints"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.write_kpoints">[docs]</a>    <span class="k">def</span> <span class="nf">write_kpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes the KPOINTS file.&quot;&quot;&quot;</span>

        <span class="c1"># Don&#39;t write anything if KSPACING is being used</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="s1">&#39;kspacing&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="s1">&#39;kspacing&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;KSPACING value </span><span class="si">{0}</span><span class="s2"> is not allowable. &quot;</span>
                                 <span class="s2">&quot;Please use None or a positive number.&quot;</span>
                                 <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="s1">&#39;kspacing&#39;</span><span class="p">]))</span>


        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span>
        <span class="n">kpoints</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;KPOINTS&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;KPOINTS created by Atomic Simulation Environment</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpts2ndarray</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">],</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;reciprocal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>

        <span class="c1"># Wrap scalar in list if necessary</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]]</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">):</span>
                <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Auto</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]:</span>
                <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Gamma</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Monkhorst-Pack</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="p">[</span><span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">kpt</span><span class="p">)</span> <span class="k">for</span> <span class="n">kpt</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">]]</span>
            <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">0 0 0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">])))</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;reciprocal&#39;</span><span class="p">]:</span>
                <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Reciprocal</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Cartesian</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">])):</span>
                <span class="p">[</span><span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">kpt</span><span class="p">)</span> <span class="k">for</span> <span class="n">kpt</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;kpts&#39;</span><span class="p">][</span><span class="n">n</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">kpoints</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1.0 </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">kpoints</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenerateVaspInput.write_potcar"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.write_potcar">[docs]</a>    <span class="k">def</span> <span class="nf">write_potcar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes the POTCAR file.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">tempfile</span>
        <span class="n">potfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;POTCAR&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ppp_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">):</span>
                    <span class="n">potfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.Z&#39;</span><span class="p">):</span>
                <span class="n">file_tmp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;gunzip -c </span><span class="si">%s</span><span class="s1"> &gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">file_tmp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_tmp</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
                    <span class="n">potfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">file_tmp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">potfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="GenerateVaspInput.write_sort_file"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.write_sort_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_sort_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes a sortings file.</span>

<span class="sd">        This file contains information about how the atoms are sorted in</span>
<span class="sd">        the first column and how they should be resorted in the second</span>
<span class="sd">        column. It is used for restart purposes to get sorting right</span>
<span class="sd">        when reading in an old calculation to ASE.&quot;&quot;&quot;</span>

        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;ase-sort.dat&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">)):</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%5i</span><span class="s1"> </span><span class="si">%5i</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resort</span><span class="p">[</span><span class="n">n</span><span class="p">]))</span></div>

<span class="c1"># The below functions are used to restart a calculation and are under early</span>
<span class="c1"># constructions</span>

<div class="viewcode-block" id="GenerateVaspInput.read_incar"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.read_incar">[docs]</a>    <span class="k">def</span> <span class="nf">read_incar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;INCAR&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method that imports settings from INCAR file.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spinpol</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Make multiplication, comments, and parameters easier to spot</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot; * &quot;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot; = &quot;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;# &quot;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="c1"># Skip empty and commented lines.</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">]:</span>
                    <span class="k">continue</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">float_keys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">float_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">exp_keys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">string_keys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">string_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">int_keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ispin&#39;</span><span class="p">:</span>
                        <span class="c1"># JRK added. not sure why we would want to leave ispin</span>
                        <span class="c1"># out</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">spinpol</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">int_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bool_keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="s1">&#39;false&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">bool_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">list_keys</span><span class="p">:</span>
                    <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dipol&#39;</span><span class="p">,</span> <span class="s1">&#39;eint&#39;</span><span class="p">,</span> <span class="s1">&#39;ferwe&#39;</span><span class="p">,</span> <span class="s1">&#39;ferdo&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;ropt&#39;</span><span class="p">,</span> <span class="s1">&#39;rwigs&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;ldauu&#39;</span><span class="p">,</span> <span class="s1">&#39;ldaul&#39;</span><span class="p">,</span> <span class="s1">&#39;ldauj&#39;</span><span class="p">,</span> <span class="s1">&#39;langevin_gamma&#39;</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
                            <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">]:</span>
                                <span class="k">break</span>
                            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;iband&#39;</span><span class="p">,</span> <span class="s1">&#39;kpuse&#39;</span><span class="p">,</span> <span class="s1">&#39;random_seed&#39;</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
                            <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">]:</span>
                                <span class="k">break</span>
                            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;magmom&#39;</span><span class="p">:</span>
                        <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
                        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;!&quot;</span><span class="p">]:</span>
                                <span class="k">break</span>
                            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span><span class="p">:</span>
                                <span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)):</span>
                                    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">list_params</span><span class="p">[</span><span class="s1">&#39;magmom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span>
                        <span class="nb">list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">set_initial_magnetic_moments</span><span class="p">(</span>
                                <span class="nb">list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">resort</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">special_keys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;lreal&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;true&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">elif</span> <span class="s1">&#39;false&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">special_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Keyword &quot;</span><span class="si">%s</span><span class="s1">&quot; in INCAR is&#39;</span>
                              <span class="s1">&#39;not known by calculator.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Value missing for keyword &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateVaspInput.read_kpoints"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.read_kpoints">[docs]</a>    <span class="k">def</span> <span class="nf">read_kpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;KPOINTS&#39;</span><span class="p">):</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">ktype</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ktype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">ktype</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="n">ktype</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
                <span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="n">ktype</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
                <span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ktype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">reciprocal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">reciprocal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                             <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">:]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">kpts</span><span class="o">=</span><span class="n">kpts</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenerateVaspInput.read_potcar"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.read_potcar">[docs]</a>    <span class="k">def</span> <span class="nf">read_potcar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read the pseudopotential XC functional from POTCAR file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;POTCAR&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Search for key &#39;LEXCH&#39; in POTCAR</span>
        <span class="n">xc_flag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;LEXCH&#39;</span><span class="p">:</span>
                <span class="n">xc_flag</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">xc_flag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;LEXCH flag not found in POTCAR file.&#39;</span><span class="p">)</span>

        <span class="c1"># Values of parameter LEXCH and corresponding XC-functional</span>
        <span class="n">xc_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PE&#39;</span><span class="p">:</span> <span class="s1">&#39;PBE&#39;</span><span class="p">,</span> <span class="s1">&#39;91&#39;</span><span class="p">:</span> <span class="s1">&#39;PW91&#39;</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">:</span> <span class="s1">&#39;LDA&#39;</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">xc_flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">xc_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown xc-functional flag found in POTCAR,&#39;</span>
                             <span class="s1">&#39; LEXCH=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">xc_flag</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_params</span><span class="p">[</span><span class="s1">&#39;pp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xc_dict</span><span class="p">[</span><span class="n">xc_flag</span><span class="p">]</span></div>

<div class="viewcode-block" id="GenerateVaspInput.todict"><a class="viewcode-back" href="../../microkinetic_toolkit.html#microkinetic_toolkit.create_input.GenerateVaspInput.todict">[docs]</a>    <span class="k">def</span> <span class="nf">todict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a dictionary of all parameters</span>
<span class="sd">        that can be used to construct a new calculator object&quot;&quot;&quot;</span>
        <span class="n">dict_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;float_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;exp_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;string_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;int_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;bool_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;list_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;special_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;dict_params&#39;</span><span class="p">,</span>
            <span class="s1">&#39;input_params&#39;</span>
        <span class="p">]</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dict_list</span><span class="p">:</span>
            <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dct</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">del</span><span class="p">(</span><span class="n">dct</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dct</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Author.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>